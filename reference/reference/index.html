
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Prediction tool for Microbiome based Remediation">
      
      
        <meta name="author" content="Alraune Zech, Sona Aseyednezhad, Robin Richardson, Jaro Camphuijsen">
      
      
        <link rel="canonical" href="https://MiBiPreT.github.io/mibipret/reference/reference/">
      
      
        <link rel="prev" href="../../getting-started/development/">
      
      
      
      <link rel="icon" href="../../assets/icon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>Reference - Mibipret</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.d7758b05.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../assets/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mibipret-api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Mibipret" class="md-header__button md-logo" aria-label="Mibipret" data-md-component="logo">
      
  <img src="../../assets/icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mibipret
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/MiBiPreT/mibipret" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    MiBiPreT/mibipret
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
    
  
  Getting started

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
    
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Mibipret" class="md-nav__button md-logo" aria-label="Mibipret" data-md-component="logo">
      
  <img src="../../assets/icon.png" alt="logo">

    </a>
    Mibipret
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/MiBiPreT/mibipret" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    MiBiPreT/mibipret
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mibipret" class="md-nav__link">
    <span class="md-ellipsis">
      mibipret
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibipret.analysis" class="md-nav__link">
    <span class="md-ellipsis">
      analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction" class="md-nav__link">
    <span class="md-ellipsis">
      reduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination" class="md-nav__link">
    <span class="md-ellipsis">
      ordination
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ordination">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.cca" class="md-nav__link">
    <span class="md-ellipsis">
      cca
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cca">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.cca--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.cca--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.check_data_frame" class="md-nav__link">
    <span class="md-ellipsis">
      check_data_frame
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_data_frame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.check_data_frame--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.check_data_frame--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.constrained_ordination" class="md-nav__link">
    <span class="md-ellipsis">
      constrained_ordination
    </span>
  </a>
  
    <nav class="md-nav" aria-label="constrained_ordination">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.constrained_ordination--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.constrained_ordination--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.extract_variables" class="md-nav__link">
    <span class="md-ellipsis">
      extract_variables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.extract_variables--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.extract_variables--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.pca" class="md-nav__link">
    <span class="md-ellipsis">
      pca
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pca">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.pca--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.pca--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.rda" class="md-nav__link">
    <span class="md-ellipsis">
      rda
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rda">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.rda--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.rda--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression" class="md-nav__link">
    <span class="md-ellipsis">
      stable_isotope_regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="stable_isotope_regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Keeling_regression" class="md-nav__link">
    <span class="md-ellipsis">
      Keeling_regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Keeling_regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Keeling_regression--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Keeling_regression--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Lambda_regression" class="md-nav__link">
    <span class="md-ellipsis">
      Lambda_regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lambda_regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Lambda_regression--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Lambda_regression--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation" class="md-nav__link">
    <span class="md-ellipsis">
      Rayleigh_fractionation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rayleigh_fractionation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.extract_isotope_data" class="md-nav__link">
    <span class="md-ellipsis">
      extract_isotope_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_isotope_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.extract_isotope_data--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.extract_isotope_data--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.valid_indices" class="md-nav__link">
    <span class="md-ellipsis">
      valid_indices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="valid_indices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.valid_indices--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.valid_indices--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.properties" class="md-nav__link">
    <span class="md-ellipsis">
      properties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA" class="md-nav__link">
    <span class="md-ellipsis">
      screening_NA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="screening_NA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.NA_traffic" class="md-nav__link">
    <span class="md-ellipsis">
      NA_traffic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NA_traffic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.NA_traffic--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.NA_traffic--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.available_NP" class="md-nav__link">
    <span class="md-ellipsis">
      available_NP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="available_NP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.available_NP--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.check_data" class="md-nav__link">
    <span class="md-ellipsis">
      check_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.check_data--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.check_data--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.electron_balance" class="md-nav__link">
    <span class="md-ellipsis">
      electron_balance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="electron_balance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.electron_balance--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.electron_balance--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.oxidators" class="md-nav__link">
    <span class="md-ellipsis">
      oxidators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="oxidators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.oxidators--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.oxidators--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.reductors" class="md-nav__link">
    <span class="md-ellipsis">
      reductors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reductors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.reductors--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.reductors--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.screening_NA" class="md-nav__link">
    <span class="md-ellipsis">
      screening_NA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="screening_NA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.screening_NA--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.screening_NA--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.thresholds_for_intervention" class="md-nav__link">
    <span class="md-ellipsis">
      thresholds_for_intervention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="thresholds_for_intervention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.thresholds_for_intervention--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.thresholds_for_intervention--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.total_contaminant_concentration" class="md-nav__link">
    <span class="md-ellipsis">
      total_contaminant_concentration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="total_contaminant_concentration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.total_contaminant_concentration--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.total_contaminant_concentration--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibipret.data" class="md-nav__link">
    <span class="md-ellipsis">
      data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data" class="md-nav__link">
    <span class="md-ellipsis">
      check_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_columns" class="md-nav__link">
    <span class="md-ellipsis">
      check_columns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_columns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_columns--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_columns--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_data_frame" class="md-nav__link">
    <span class="md-ellipsis">
      check_data_frame
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_data_frame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_data_frame--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_data_frame--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_units" class="md-nav__link">
    <span class="md-ellipsis">
      check_units
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_units">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_units--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_values" class="md-nav__link">
    <span class="md-ellipsis">
      check_values
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_values--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.standard_names" class="md-nav__link">
    <span class="md-ellipsis">
      standard_names
    </span>
  </a>
  
    <nav class="md-nav" aria-label="standard_names">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.standard_names--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.standard_names--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.standardize" class="md-nav__link">
    <span class="md-ellipsis">
      standardize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="standardize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.standardize--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.example_data" class="md-nav__link">
    <span class="md-ellipsis">
      example_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="example_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.example_data.example_data" class="md-nav__link">
    <span class="md-ellipsis">
      example_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="example_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.example_data.example_data--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.load_data" class="md-nav__link">
    <span class="md-ellipsis">
      load_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="load_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.load_data.load_csv" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv
    </span>
  </a>
  
    <nav class="md-nav" aria-label="load_csv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.load_data.load_csv--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.load_data.load_excel" class="md-nav__link">
    <span class="md-ellipsis">
      load_excel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="load_excel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.load_data.load_excel--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.names_data" class="md-nav__link">
    <span class="md-ellipsis">
      names_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.names_metabolites" class="md-nav__link">
    <span class="md-ellipsis">
      names_metabolites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data" class="md-nav__link">
    <span class="md-ellipsis">
      set_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="set_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.compare_lists" class="md-nav__link">
    <span class="md-ellipsis">
      compare_lists
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compare_lists">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.compare_lists--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.compare_lists--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.compare_lists--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.extract_data" class="md-nav__link">
    <span class="md-ellipsis">
      extract_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.extract_data--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.extract_data--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.merge_data" class="md-nav__link">
    <span class="md-ellipsis">
      merge_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="merge_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.merge_data--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.merge_data--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.unit_settings" class="md-nav__link">
    <span class="md-ellipsis">
      unit_settings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibipret.visualize" class="md-nav__link">
    <span class="md-ellipsis">
      visualize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="visualize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.activity" class="md-nav__link">
    <span class="md-ellipsis">
      activity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="activity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.activity.activity" class="md-nav__link">
    <span class="md-ellipsis">
      activity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="activity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.activity.activity--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.activity.activity--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.ordination_plot" class="md-nav__link">
    <span class="md-ellipsis">
      ordination_plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ordination_plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.ordination_plot.ordination_plot" class="md-nav__link">
    <span class="md-ellipsis">
      ordination_plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ordination_plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.ordination_plot.ordination_plot--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.ordination_plot.ordination_plot--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.stable_isotope_plots" class="md-nav__link">
    <span class="md-ellipsis">
      stable_isotope_plots
    </span>
  </a>
  
    <nav class="md-nav" aria-label="stable_isotope_plots">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.stable_isotope_plots.Keeling_plot" class="md-nav__link">
    <span class="md-ellipsis">
      Keeling_plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Keeling_plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.stable_isotope_plots.Keeling_plot--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.stable_isotope_plots.Lambda_plot" class="md-nav__link">
    <span class="md-ellipsis">
      Lambda_plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lambda_plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.stable_isotope_plots.Lambda_plot--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.stable_isotope_plots.Rayleigh_fractionation_plot" class="md-nav__link">
    <span class="md-ellipsis">
      Rayleigh_fractionation_plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rayleigh_fractionation_plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.stable_isotope_plots.Rayleigh_fractionation_plot--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mibipret" class="md-nav__link">
    <span class="md-ellipsis">
      mibipret
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibipret.analysis" class="md-nav__link">
    <span class="md-ellipsis">
      analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction" class="md-nav__link">
    <span class="md-ellipsis">
      reduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination" class="md-nav__link">
    <span class="md-ellipsis">
      ordination
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ordination">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.cca" class="md-nav__link">
    <span class="md-ellipsis">
      cca
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cca">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.cca--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.cca--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.check_data_frame" class="md-nav__link">
    <span class="md-ellipsis">
      check_data_frame
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_data_frame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.check_data_frame--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.check_data_frame--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.constrained_ordination" class="md-nav__link">
    <span class="md-ellipsis">
      constrained_ordination
    </span>
  </a>
  
    <nav class="md-nav" aria-label="constrained_ordination">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.constrained_ordination--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.constrained_ordination--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.extract_variables" class="md-nav__link">
    <span class="md-ellipsis">
      extract_variables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.extract_variables--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.extract_variables--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.pca" class="md-nav__link">
    <span class="md-ellipsis">
      pca
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pca">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.pca--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.pca--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.rda" class="md-nav__link">
    <span class="md-ellipsis">
      rda
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rda">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.rda--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.ordination.rda--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression" class="md-nav__link">
    <span class="md-ellipsis">
      stable_isotope_regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="stable_isotope_regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Keeling_regression" class="md-nav__link">
    <span class="md-ellipsis">
      Keeling_regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Keeling_regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Keeling_regression--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Keeling_regression--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Lambda_regression" class="md-nav__link">
    <span class="md-ellipsis">
      Lambda_regression
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lambda_regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Lambda_regression--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Lambda_regression--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation" class="md-nav__link">
    <span class="md-ellipsis">
      Rayleigh_fractionation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rayleigh_fractionation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.extract_isotope_data" class="md-nav__link">
    <span class="md-ellipsis">
      extract_isotope_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_isotope_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.extract_isotope_data--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.extract_isotope_data--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.valid_indices" class="md-nav__link">
    <span class="md-ellipsis">
      valid_indices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="valid_indices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.valid_indices--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.reduction.stable_isotope_regression.valid_indices--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.properties" class="md-nav__link">
    <span class="md-ellipsis">
      properties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA" class="md-nav__link">
    <span class="md-ellipsis">
      screening_NA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="screening_NA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.NA_traffic" class="md-nav__link">
    <span class="md-ellipsis">
      NA_traffic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NA_traffic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.NA_traffic--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.NA_traffic--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.available_NP" class="md-nav__link">
    <span class="md-ellipsis">
      available_NP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="available_NP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.available_NP--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.check_data" class="md-nav__link">
    <span class="md-ellipsis">
      check_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.check_data--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.check_data--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.electron_balance" class="md-nav__link">
    <span class="md-ellipsis">
      electron_balance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="electron_balance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.electron_balance--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.electron_balance--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.oxidators" class="md-nav__link">
    <span class="md-ellipsis">
      oxidators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="oxidators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.oxidators--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.oxidators--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.reductors" class="md-nav__link">
    <span class="md-ellipsis">
      reductors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reductors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.reductors--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.reductors--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.screening_NA" class="md-nav__link">
    <span class="md-ellipsis">
      screening_NA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="screening_NA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.screening_NA--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.screening_NA--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.thresholds_for_intervention" class="md-nav__link">
    <span class="md-ellipsis">
      thresholds_for_intervention
    </span>
  </a>
  
    <nav class="md-nav" aria-label="thresholds_for_intervention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.thresholds_for_intervention--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.thresholds_for_intervention--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.total_contaminant_concentration" class="md-nav__link">
    <span class="md-ellipsis">
      total_contaminant_concentration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="total_contaminant_concentration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.total_contaminant_concentration--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.analysis.sample.screening_NA.total_contaminant_concentration--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibipret.data" class="md-nav__link">
    <span class="md-ellipsis">
      data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data" class="md-nav__link">
    <span class="md-ellipsis">
      check_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_columns" class="md-nav__link">
    <span class="md-ellipsis">
      check_columns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_columns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_columns--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_columns--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_data_frame" class="md-nav__link">
    <span class="md-ellipsis">
      check_data_frame
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_data_frame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_data_frame--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_data_frame--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_units" class="md-nav__link">
    <span class="md-ellipsis">
      check_units
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_units">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_units--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_values" class="md-nav__link">
    <span class="md-ellipsis">
      check_values
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.check_values--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.standard_names" class="md-nav__link">
    <span class="md-ellipsis">
      standard_names
    </span>
  </a>
  
    <nav class="md-nav" aria-label="standard_names">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.standard_names--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.standard_names--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.standardize" class="md-nav__link">
    <span class="md-ellipsis">
      standardize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="standardize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.check_data.standardize--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.example_data" class="md-nav__link">
    <span class="md-ellipsis">
      example_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="example_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.example_data.example_data" class="md-nav__link">
    <span class="md-ellipsis">
      example_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="example_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.example_data.example_data--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.load_data" class="md-nav__link">
    <span class="md-ellipsis">
      load_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="load_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.load_data.load_csv" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv
    </span>
  </a>
  
    <nav class="md-nav" aria-label="load_csv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.load_data.load_csv--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.load_data.load_excel" class="md-nav__link">
    <span class="md-ellipsis">
      load_excel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="load_excel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.load_data.load_excel--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.names_data" class="md-nav__link">
    <span class="md-ellipsis">
      names_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.names_metabolites" class="md-nav__link">
    <span class="md-ellipsis">
      names_metabolites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data" class="md-nav__link">
    <span class="md-ellipsis">
      set_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="set_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.compare_lists" class="md-nav__link">
    <span class="md-ellipsis">
      compare_lists
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compare_lists">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.compare_lists--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.compare_lists--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.compare_lists--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.extract_data" class="md-nav__link">
    <span class="md-ellipsis">
      extract_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.extract_data--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.extract_data--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.merge_data" class="md-nav__link">
    <span class="md-ellipsis">
      merge_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="merge_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.merge_data--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.set_data.merge_data--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.data.unit_settings" class="md-nav__link">
    <span class="md-ellipsis">
      unit_settings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mibipret.visualize" class="md-nav__link">
    <span class="md-ellipsis">
      visualize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="visualize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.activity" class="md-nav__link">
    <span class="md-ellipsis">
      activity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="activity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.activity.activity" class="md-nav__link">
    <span class="md-ellipsis">
      activity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="activity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.activity.activity--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.activity.activity--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.ordination_plot" class="md-nav__link">
    <span class="md-ellipsis">
      ordination_plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ordination_plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.ordination_plot.ordination_plot" class="md-nav__link">
    <span class="md-ellipsis">
      ordination_plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ordination_plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.ordination_plot.ordination_plot--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.ordination_plot.ordination_plot--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.stable_isotope_plots" class="md-nav__link">
    <span class="md-ellipsis">
      stable_isotope_plots
    </span>
  </a>
  
    <nav class="md-nav" aria-label="stable_isotope_plots">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.stable_isotope_plots.Keeling_plot" class="md-nav__link">
    <span class="md-ellipsis">
      Keeling_plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Keeling_plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.stable_isotope_plots.Keeling_plot--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.stable_isotope_plots.Lambda_plot" class="md-nav__link">
    <span class="md-ellipsis">
      Lambda_plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lambda_plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.stable_isotope_plots.Lambda_plot--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.stable_isotope_plots.Rayleigh_fractionation_plot" class="md-nav__link">
    <span class="md-ellipsis">
      Rayleigh_fractionation_plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rayleigh_fractionation_plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mibipret.visualize.stable_isotope_plots.Rayleigh_fractionation_plot--input" class="md-nav__link">
    <span class="md-ellipsis">
      Input
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="mibipret-api-reference"><code>mibipret</code> API reference</h1>


<div class="doc doc-object doc-module">



<a id="mibipret"></a>
    <div class="doc doc-contents first">

        <p>Documentation about mibipret.</p>








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h2 id="mibipret.analysis" class="doc doc-heading">
            <code>analysis</code>


</h2>

    <div class="doc doc-contents ">

        <p>mibipret module for data analysis.</p>








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h3 id="mibipret.analysis.reduction" class="doc doc-heading">
            <code>reduction</code>


</h3>

    <div class="doc doc-contents ">

        <p>mibipret module for data analysis reducing sample data.</p>








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h4 id="mibipret.analysis.reduction.ordination" class="doc doc-heading">
            <code>ordination</code>


</h4>

    <div class="doc doc-contents ">

        <p>Routines for performing ordination statistics on sample data.</p>
<p>@author: Alraune Zech, Jorrit Bakker</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.reduction.ordination.cca" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cca</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">independent_variables</span><span class="p">,</span> <span class="n">dependent_variables</span><span class="p">,</span> <span class="n">n_comp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Function that performs Canonical Correspondence Analysis.</p>
<p>Function makes use of skbio.stats.ordination.CCA on the input data and gives
the site scores and loadings.</p>
<h6 id="mibipret.analysis.reduction.ordination.cca--input">Input</h6>
<div class="highlight"><pre><span></span><code>data_frame : pd.dataframe
    Tabular data containing variables to be evaluated with standard
    column names and rows of sample data.
independent_variables : list of strings
    list with column names data to be the independent variables (=environment)
dependent_variables : list of strings
    list with column names data to be the dependen variables (=species)
n_comp : int, default is 2
    number of dimensions to return
verbose : Boolean, The default is False.
    Set to True to get messages in the Console about the status of the run code.
</code></pre></div>
<h6 id="mibipret.analysis.reduction.ordination.cca--output">Output</h6>
<div class="highlight"><pre><span></span><code>results : Dictionary
    * method: name of ordination method (str)
    * loadings_independent: loadings of independent variables (np.ndarray)
    * loadings_dependent: loadings of dependent variables (np.ndarray)
    * names_independent: names of independent varialbes (list of str)
    * names_dependent: names of dependent varialbes (list of str)
    * scores: scores (np.ndarray)
    * sample_index: names of samples (list of str)
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/reduction/ordination.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="k">def</span><span class="w"> </span><span class="nf">cca</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">n_comp</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="p">):</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function that performs Canonical Correspondence Analysis.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    Function makes use of skbio.stats.ordination.CCA on the input data and gives</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    the site scores and loadings.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    Input</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    -----</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        data_frame : pd.dataframe</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            Tabular data containing variables to be evaluated with standard</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            column names and rows of sample data.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        independent_variables : list of strings</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">            list with column names data to be the independent variables (=environment)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        dependent_variables : list of strings</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">            list with column names data to be the dependen variables (=species)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        n_comp : int, default is 2</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            number of dimensions to return</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        verbose : Boolean, The default is False.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">            Set to True to get messages in the Console about the status of the run code.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    Output</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    ------</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        results : Dictionary</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            * method: name of ordination method (str)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            * loadings_independent: loadings of independent variables (np.ndarray)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            * loadings_dependent: loadings of dependent variables (np.ndarray)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            * names_independent: names of independent varialbes (list of str)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">            * names_dependent: names of dependent varialbes (list of str)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            * scores: scores (np.ndarray)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            * sample_index: names of samples (list of str)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;cca()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="n">results</span> <span class="o">=</span> <span class="n">constrained_ordination</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>                           <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>                           <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                           <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;cca&#39;</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                           <span class="n">n_comp</span> <span class="o">=</span> <span class="n">n_comp</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                           <span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.reduction.ordination.check_data_frame" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Checking data on correct format.</p>
<h6 id="mibipret.analysis.reduction.ordination.check_data_frame--input">Input</h6>
<div class="highlight"><pre><span></span><code>data_frame: pd.DataFrame
    quantities for data analysis given per sample
</code></pre></div>
<h6 id="mibipret.analysis.reduction.ordination.check_data_frame--output">Output</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    copy of given dataframe with index set to sample name
cols: list
    List of column names
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/reduction/ordination.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">):</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checking data on correct format.</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">    Input</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    -----</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        data_frame: pd.DataFrame</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">            quantities for data analysis given per sample</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">    Output</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">    ------</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">            copy of given dataframe with index set to sample name</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">        cols: list</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">            List of column names</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Calculation not possible with given data. </span><span class="se">\</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="s2">                          Data has to be a panda-DataFrame or Series </span><span class="se">\</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="s2">                          but is given as type </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data_frame</span><span class="p">)))</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data_frame</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="n">cols</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="k">if</span> <span class="n">name_sample</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>            <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">name_sample</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="n">cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">name_sample</span><span class="p">)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">cols</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.reduction.ordination.constrained_ordination" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">constrained_ordination</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">independent_variables</span><span class="p">,</span> <span class="n">dependent_variables</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cca&#39;</span><span class="p">,</span> <span class="n">n_comp</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Function that performs constrained ordination.</p>
<p>Function makes use of skbio.stats.ordination on the input data and gives
the scores and loadings.</p>
<h6 id="mibipret.analysis.reduction.ordination.constrained_ordination--input">Input</h6>
<div class="highlight"><pre><span></span><code>data_frame : pd.DataFrame
    Tabular data containing variables to be evaluated with standard
    column names and rows of sample data.
independent_variables : list of strings
   list with column names data to be the independent variables (=environment)
dependent_variables : list of strings
   list with column names data to be the dependen variables (=species)
method : string, default is cca
    specification of ordination method of choice. Options &#39;cca&#39; &amp; &#39;rda&#39;
n_comp : int, default is 2
    number of dimensions to return
</code></pre></div>
<h6 id="mibipret.analysis.reduction.ordination.constrained_ordination--output">Output</h6>
<div class="highlight"><pre><span></span><code>results : Dictionary
    * method: name of ordination method (str)
    * loadings_independent: loadings of independent variables (np.ndarray)
    * loadings_dependent: loadings of dependent variables (np.ndarray)
    * names_independent: names of independent varialbes (list of str)
    * names_dependent: names of dependent varialbes (list of str)
    * scores: scores (np.ndarray)
    * sample_index: names of samples (list of str)
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/reduction/ordination.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="k">def</span><span class="w"> </span><span class="nf">constrained_ordination</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>                           <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>                           <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>                           <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;cca&#39;</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>                           <span class="n">n_comp</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="p">):</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function that performs constrained ordination.</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    Function makes use of skbio.stats.ordination on the input data and gives</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    the scores and loadings.</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    Input</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    -----</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        data_frame : pd.DataFrame</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            Tabular data containing variables to be evaluated with standard</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">            column names and rows of sample data.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        independent_variables : list of strings</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">           list with column names data to be the independent variables (=environment)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        dependent_variables : list of strings</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">           list with column names data to be the dependen variables (=species)</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        method : string, default is cca</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">            specification of ordination method of choice. Options &#39;cca&#39; &amp; &#39;rda&#39;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        n_comp : int, default is 2</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">            number of dimensions to return</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    Output</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">    ------</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">        results : Dictionary</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">            * method: name of ordination method (str)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">            * loadings_independent: loadings of independent variables (np.ndarray)</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">            * loadings_dependent: loadings of dependent variables (np.ndarray)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">            * names_independent: names of independent varialbes (list of str)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">            * names_dependent: names of dependent varialbes (list of str)</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">            * scores: scores (np.ndarray)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">            * sample_index: names of samples (list of str)</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="n">intersection</span> <span class="o">=</span> <span class="n">extract_variables</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>                          <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                          <span class="n">name_variables</span> <span class="o">=</span> <span class="s1">&#39;independent variables&#39;</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                          <span class="p">)</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="n">data_independent_variables</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">intersection</span><span class="p">]</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">intersection</span> <span class="o">=</span> <span class="n">extract_variables</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>                          <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>                          <span class="n">name_variables</span> <span class="o">=</span> <span class="s1">&#39;dependent variables&#39;</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>                          <span class="p">)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="n">data_dependent_variables</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">intersection</span><span class="p">]</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="c1"># Checking if the dimensions of the dataframe allow for CCA</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">data_dependent_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">data_dependent_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> \
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="p">(</span><span class="n">data_independent_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">data_independent_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Ordination method </span><span class="si">{}</span><span class="s2"> not possible with more variables than samples.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method</span><span class="p">))</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="c1"># Performing constrained ordination using function from scikit-bio.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;cca&#39;</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="n">sci_ordination</span> <span class="o">=</span> <span class="n">sciord</span><span class="o">.</span><span class="n">cca</span><span class="p">(</span><span class="n">data_dependent_variables</span><span class="p">,</span> <span class="n">data_independent_variables</span><span class="p">,</span> <span class="n">scaling</span> <span class="o">=</span> <span class="n">n_comp</span><span class="p">)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="k">except</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span><span class="ne">ValueError</span><span class="p">):</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Not all column values are numeric values. Consider standardizing data first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;rda&#39;</span><span class="p">:</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>            <span class="n">sci_ordination</span> <span class="o">=</span> <span class="n">sciord</span><span class="o">.</span><span class="n">rda</span><span class="p">(</span><span class="n">data_dependent_variables</span><span class="p">,</span> <span class="n">data_independent_variables</span><span class="p">,</span> <span class="n">scaling</span> <span class="o">=</span> <span class="n">n_comp</span><span class="p">)</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="k">except</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span><span class="ne">ValueError</span><span class="p">):</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Not all column values are numeric values. Consider standardizing data first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Ordination method </span><span class="si">{}</span><span class="s2"> not a valid option.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method</span><span class="p">))</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="n">loadings_independent</span> <span class="o">=</span> <span class="n">sci_ordination</span><span class="o">.</span><span class="n">biplot_scores</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">n_comp</span><span class="p">]</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">loadings_dependent</span> <span class="o">=</span> <span class="n">sci_ordination</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">n_comp</span><span class="p">]</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="n">scores</span> <span class="o">=</span> <span class="n">sci_ordination</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">n_comp</span><span class="p">]</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="k">if</span> <span class="n">loadings_independent</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="n">n_comp</span><span class="p">:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number of dependent variables too small.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>               <span class="s2">&quot;loadings_dependent&quot;</span><span class="p">:</span> <span class="n">loadings_dependent</span><span class="p">,</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>               <span class="s2">&quot;loadings_independent&quot;</span><span class="p">:</span> <span class="n">loadings_independent</span><span class="p">,</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>               <span class="s2">&quot;names_independent&quot;</span> <span class="p">:</span> <span class="n">data_independent_variables</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>               <span class="s2">&quot;names_dependent&quot;</span> <span class="p">:</span> <span class="n">data_dependent_variables</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>               <span class="s2">&quot;scores&quot;</span><span class="p">:</span> <span class="n">scores</span><span class="p">,</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>               <span class="s2">&quot;sample_index&quot;</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>               <span class="p">}</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.reduction.ordination.extract_variables" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_variables</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">name_variables</span><span class="o">=</span><span class="s1">&#39;variables&#39;</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Checking overlap of two given list.</p>
<p>Function is used for checking if a list of variables is present in
the column names of a given dataframe (of quantities for data analysis)</p>
<h6 id="mibipret.analysis.reduction.ordination.extract_variables--input">Input</h6>
<div class="highlight"><pre><span></span><code>columns: list of strings
    given extensive list (usually column names of a pd.DataFrame)
variables: list of strings
    list of names to extract/check overlap with strings in list &#39;column&#39;
name_variables: str, default is &#39;variables&#39;
    name of type of variables given in list &#39;variables&#39;
</code></pre></div>
<h6 id="mibipret.analysis.reduction.ordination.extract_variables--output">Output</h6>
<div class="highlight"><pre><span></span><code>intersection: list
    list of strings present in both lists &#39;columns&#39; and &#39;variables&#39;
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/reduction/ordination.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="k">def</span><span class="w"> </span><span class="nf">extract_variables</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>                      <span class="n">variables</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>                      <span class="n">name_variables</span> <span class="o">=</span> <span class="s1">&#39;variables&#39;</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>                      <span class="p">):</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checking overlap of two given list.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    Function is used for checking if a list of variables is present in</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">    the column names of a given dataframe (of quantities for data analysis)</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    Input</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">    -----</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">        columns: list of strings</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">            given extensive list (usually column names of a pd.DataFrame)</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        variables: list of strings</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">            list of names to extract/check overlap with strings in list &#39;column&#39;</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">        name_variables: str, default is &#39;variables&#39;</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">            name of type of variables given in list &#39;variables&#39;</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">    Output</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">    ------</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">        intersection: list</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">            list of strings present in both lists &#39;columns&#39; and &#39;variables&#39;</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="n">intersection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">variables</span><span class="p">))</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="n">remainder</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">columns</span><span class="p">))</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No column names for &#39;</span><span class="si">{}</span><span class="s2">&#39; identified in columns of dataframe.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_variables</span><span class="p">))</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: not all column names for &#39;</span><span class="si">{}</span><span class="s2">&#39; are found in dataframe.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_variables</span><span class="p">))</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columns used in analysis:&quot;</span><span class="p">,</span> <span class="n">intersection</span><span class="p">)</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Column names not identified in data:&quot;</span><span class="p">,</span> <span class="n">remainder</span><span class="p">)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;List of column names for &#39;</span><span class="si">{}</span><span class="s2">&#39; empty or in wrong format.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_variables</span><span class="p">))</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="k">return</span> <span class="n">intersection</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.reduction.ordination.pca" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pca</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">independent_variables</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dependent_variables</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_comp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Function that performs Principal Component Analysis.</p>
<p>Makes use of routine sklearn.decomposition.PCA on the input data and gives
the site scores and loadings.</p>
<p>Principal component analysis (PCA) is a linear dimensionality reduction
technique with applications in exploratory data analysis, visualization
and data preprocessing. The data is linearly transformed onto a new
coordinate system such that the directions (principal components) capturing
the largest variation in the data can be easily identified.</p>
<h6 id="mibipret.analysis.reduction.ordination.pca--input">Input</h6>
<div class="highlight"><pre><span></span><code>data_frame : pd.dataframe
    Tabular data containing variables to be evaluated with standard
    column names and rows of sample data.
independent_variables : Boolean or list of strings; default False
    list with column names to select from data_frame
    being characterized as independent variables (= environment)
dependent_variables : Boolean or list of strings; default is False
    list with column names to select from data_frame
    being characterized as dependent variables (= species)
n_comp : int, default is 2
    Number of components to report
verbose : Boolean, The default is False.
   Set to True to get messages in the Console about the status of the run code.
</code></pre></div>
<h6 id="mibipret.analysis.reduction.ordination.pca--output">Output</h6>
<div class="highlight"><pre><span></span><code>results : Dictionary
    containing the scores and loadings of the PCA,
    the percentage of the variation explained by the first principal components,
    the correlation coefficient between the first two PCs,
    names of columns (same length as loadings)
    names of indices (same length as scores)
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/reduction/ordination.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">def</span><span class="w"> </span><span class="nf">pca</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>        <span class="n">independent_variables</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>        <span class="n">dependent_variables</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="n">n_comp</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="p">):</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function that performs Principal Component Analysis.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    Makes use of routine sklearn.decomposition.PCA on the input data and gives</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    the site scores and loadings.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Principal component analysis (PCA) is a linear dimensionality reduction</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    technique with applications in exploratory data analysis, visualization</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    and data preprocessing. The data is linearly transformed onto a new</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    coordinate system such that the directions (principal components) capturing</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    the largest variation in the data can be easily identified.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    Input</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    -----</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        data_frame : pd.dataframe</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">            Tabular data containing variables to be evaluated with standard</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">            column names and rows of sample data.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        independent_variables : Boolean or list of strings; default False</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            list with column names to select from data_frame</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">            being characterized as independent variables (= environment)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        dependent_variables : Boolean or list of strings; default is False</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">            list with column names to select from data_frame</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">            being characterized as dependent variables (= species)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        n_comp : int, default is 2</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">            Number of components to report</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        verbose : Boolean, The default is False.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">           Set to True to get messages in the Console about the status of the run code.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    Output</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    ------</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        results : Dictionary</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            containing the scores and loadings of the PCA,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">            the percentage of the variation explained by the first principal components,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">            the correlation coefficient between the first two PCs,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">            names of columns (same length as loadings)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">            names of indices (same length as scores)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;pca()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="k">if</span> <span class="n">independent_variables</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">dependent_variables</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">data_pca</span> <span class="o">=</span> <span class="n">data</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">names_independent</span> <span class="o">=</span> <span class="n">cols</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">names_dependent</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="k">elif</span> <span class="n">independent_variables</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">dependent_variables</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="n">names_independent</span> <span class="o">=</span> <span class="n">extract_variables</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>                              <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>                              <span class="n">name_variables</span> <span class="o">=</span> <span class="s1">&#39;independent variables&#39;</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>                              <span class="p">)</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">names_dependent</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="n">data_pca</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">names_independent</span><span class="p">]</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="k">elif</span> <span class="n">independent_variables</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">dependent_variables</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">names_dependent</span> <span class="o">=</span> <span class="n">extract_variables</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>                              <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>                              <span class="n">name_variables</span> <span class="o">=</span> <span class="s1">&#39;dependent variables&#39;</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>                              <span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">names_independent</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="n">data_pca</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">names_dependent</span><span class="p">]</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">names_independent</span> <span class="o">=</span> <span class="n">extract_variables</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>                              <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                              <span class="n">name_variables</span> <span class="o">=</span> <span class="s1">&#39;independent variables&#39;</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>                              <span class="p">)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="n">names_dependent</span> <span class="o">=</span> <span class="n">extract_variables</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>                              <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>                              <span class="n">name_variables</span> <span class="o">=</span> <span class="s1">&#39;dependent variables&#39;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>                              <span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="n">data_pca</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">names_independent</span> <span class="o">+</span> <span class="n">names_dependent</span><span class="p">]</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="c1"># Checking if the dimensions of the dataframe allow for PCA</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="k">if</span> <span class="n">data_pca</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">data_pca</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;PCA not possible with more variables than samples.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="c1"># Using scikit.decomposoition.PCA with an amount of components equal</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="c1"># to the amount of variables, then getting the loadings, scores and explained variance ratio.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">pca</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data_pca</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_pca</span><span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">loadings</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">PCAscores</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">data_pca</span><span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="n">variances</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="k">except</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span><span class="ne">TypeError</span><span class="p">):</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Not all column values are numeric values (or NaN). Consider standardizing data first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="c1"># Taking the first two PC for plotting</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="k">if</span> <span class="n">dependent_variables</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="n">loadings_independent</span> <span class="o">=</span> <span class="n">loadings</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">n_comp</span><span class="p">]</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">loadings_dependent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[],[]])</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">loadings_independent</span> <span class="o">=</span> <span class="n">loadings</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">names_dependent</span><span class="p">),</span> <span class="mi">0</span><span class="p">:</span><span class="n">n_comp</span><span class="p">]</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">loadings_dependent</span> <span class="o">=</span> <span class="n">loadings</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">names_dependent</span><span class="p">):,</span> <span class="mi">0</span><span class="p">:</span><span class="n">n_comp</span><span class="p">]</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">scores</span> <span class="o">=</span> <span class="n">PCAscores</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">n_comp</span><span class="p">]</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">percent_explained</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">variances</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">variances</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">coef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">scores</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">scores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Information about the success of the PCA:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">percent_explained</span><span class="p">)):</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Principle component </span><span class="si">{}</span><span class="s1"> explains </span><span class="si">{}% o</span><span class="s1">f the total variance.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">percent_explained</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The correlation coefficient between PC1 and PC2 is </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coef</span><span class="p">))</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s1">&#39;pca&#39;</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>               <span class="s2">&quot;loadings_dependent&quot;</span><span class="p">:</span> <span class="n">loadings_dependent</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>               <span class="s2">&quot;loadings_independent&quot;</span><span class="p">:</span> <span class="n">loadings_independent</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>               <span class="s2">&quot;names_independent&quot;</span> <span class="p">:</span> <span class="n">names_independent</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>               <span class="s2">&quot;names_dependent&quot;</span> <span class="p">:</span> <span class="n">names_dependent</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>               <span class="s2">&quot;scores&quot;</span><span class="p">:</span> <span class="n">scores</span><span class="p">,</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>               <span class="s2">&quot;sample_index&quot;</span> <span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_pca</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>               <span class="s2">&quot;percent_explained&quot;</span><span class="p">:</span> <span class="n">percent_explained</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>               <span class="s2">&quot;corr_PC1_PC2&quot;</span><span class="p">:</span> <span class="n">coef</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>               <span class="p">}</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.reduction.ordination.rda" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rda</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">independent_variables</span><span class="p">,</span> <span class="n">dependent_variables</span><span class="p">,</span> <span class="n">n_comp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Function that performs Redundancy Analysis.</p>
<p>Function makes use of skbio.stats.ordination.RDA on the input data and gives
the site scores and loadings.</p>
<h6 id="mibipret.analysis.reduction.ordination.rda--input">Input</h6>
<div class="highlight"><pre><span></span><code>data_frame : pd.dataframe
    Tabular data containing variables to be evaluated with standard
    column names and rows of sample data.
independent_variables : list of strings
    list with column names data to be the independent variables (=envirnoment)
dependent_variables : list of strings
    list with column names data to be the dependent variables (=species)
n_comp : int, default is 2
    number of dimensions to return
verbose : Boolean, The default is False.
    Set to True to get messages in the Console about the status of the run code.
</code></pre></div>
<h6 id="mibipret.analysis.reduction.ordination.rda--output">Output</h6>
<div class="highlight"><pre><span></span><code>results : Dictionary
    * method: name of ordination method (str)
    * loadings_independent: loadings of independent variables (np.ndarray)
    * loadings_dependent: loadings of dependent variables (np.ndarray)
    * names_independent: names of independent varialbes (list of str)
    * names_dependent: names of dependent varialbes (list of str)
    * scores: scores (np.ndarray)
    * sample_index: names of samples (list of str)
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/reduction/ordination.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="k">def</span><span class="w"> </span><span class="nf">rda</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="n">n_comp</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="p">):</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function that performs Redundancy Analysis.</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    Function makes use of skbio.stats.ordination.RDA on the input data and gives</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    the site scores and loadings.</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">    Input</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">    -----</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        data_frame : pd.dataframe</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">            Tabular data containing variables to be evaluated with standard</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">            column names and rows of sample data.</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        independent_variables : list of strings</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">            list with column names data to be the independent variables (=envirnoment)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        dependent_variables : list of strings</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">            list with column names data to be the dependent variables (=species)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        n_comp : int, default is 2</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            number of dimensions to return</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        verbose : Boolean, The default is False.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">            Set to True to get messages in the Console about the status of the run code.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">    Output</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    ------</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        results : Dictionary</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            * method: name of ordination method (str)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">            * loadings_independent: loadings of independent variables (np.ndarray)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">            * loadings_dependent: loadings of dependent variables (np.ndarray)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">            * names_independent: names of independent varialbes (list of str)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">            * names_dependent: names of dependent varialbes (list of str)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">            * scores: scores (np.ndarray)</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">            * sample_index: names of samples (list of str)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;rda()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="n">results</span> <span class="o">=</span> <span class="n">constrained_ordination</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>                           <span class="n">independent_variables</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>                           <span class="n">dependent_variables</span><span class="p">,</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>                           <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;rda&#39;</span><span class="p">,</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>                           <span class="n">n_comp</span> <span class="o">=</span> <span class="n">n_comp</span><span class="p">,</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>                           <span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="mibipret.analysis.reduction.stable_isotope_regression" class="doc doc-heading">
            <code>stable_isotope_regression</code>


</h4>

    <div class="doc doc-contents ">

        <p>Routines for performing linear regression on isotope data.</p>
<p>@author: Alraune Zech</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.reduction.stable_isotope_regression.Keeling_regression" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Keeling_regression</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span> <span class="n">delta_mix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">relative_abundance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validate_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Performing a linear regression linked to the Keeling plot.</p>
<p>A Keeling fit/plot is an approach to identify the isotopic composition of a
contaminating source from measured concentrations and isotopic composition
(delta) of a target species in the mix of the source and a pool.</p>
<p>It is based on the linear relationship of the given quantities (concentration)
and delta-values (or alternatively the relative abundance x) which are measured
over time or across a spatial interval according to</p>
<div class="highlight"><pre><span></span><code>delta_mix = delta_source + m * 1/c_mix
</code></pre></div>
<p>where m is the slope relating the isotopic quantities of the pool (which mixes
with the sourse) by m = (delta_pool + delta_source)*c_pool.</p>
<p>The analysis is based on a linear regression of the inverse concentration
data against the delta (or x)-values. The parameter of interest, the delta
(or relative_abundance, respectively) of the source quantity is the
intercept of linear fit with the y-axis, or in other words, the absolute
value of the linear fit function.</p>
<p>A plot of the results with data and linear trendline can be generate with the
method Keeling_plot() [in the module visualize].</p>
<p>Note that the approach is only applicable if
    (i)  the isotopic composition of the unknown source is constant
    (ii) the concentration and isotopic composition of the target compound
        is constant (over time or across space)
        (i.e. in absence of contamination from the unknown source)</p>
<h6 id="mibipret.analysis.reduction.stable_isotope_regression.Keeling_regression--input">Input</h6>
<div class="highlight"><pre><span></span><code>concentration : np.array, pd.dataframe
    total molecular mass/molar concentration of target substance
    at different locations (at a time) or at different times (at one location)
delta_mix : np.array, pd.dataframe (same length as c_mix), default None
    relative isotope ratio (delta-value) of target substance
relative_abundance : None or np.array, pd.dataframe (same length as c_mix), default None
    if not None it replaces delta_mix in the inverse estimation and plotting
    relative abundance of target substance
validate_indices: boolean, default True
    flag to run index validation (i.e. removal of nan and infinity values)
verbose : Boolean, The default is False.
   Set to True to get messages in the Console about the status of the run code.
**kwargs : dict
    keywordarguments dictionary, e.g. for passing forward keywords to
    valid_indices()
</code></pre></div>
<h6 id="mibipret.analysis.reduction.stable_isotope_regression.Keeling_regression--returns">Returns</h6>
<div class="highlight"><pre><span></span><code>results : dict
    results of fitting, including:
        * coefficients : array/list of lenght 2, where coefficients[0]
            is the slope of the linear fit and coefficient[1] is the
            intercept of linear fit with y-axis, reflecting delta
            (or relative_abundance, respectively) of the source quantity
        * delta_C: np.array with isotope used for fitting - all samples
            where non-zero values are available for delta_C and delta_H
        * delta_H: np.array with isotope used for fitting - all samples
            where non-zero values are available for delta_C and delta_H
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/reduction/stable_isotope_regression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="k">def</span><span class="w"> </span><span class="nf">Keeling_regression</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                       <span class="n">delta_mix</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                       <span class="n">relative_abundance</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                       <span class="n">validate_indices</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                       <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                       <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                       <span class="p">):</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performing a linear regression linked to the Keeling plot.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    A Keeling fit/plot is an approach to identify the isotopic composition of a</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    contaminating source from measured concentrations and isotopic composition</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    (delta) of a target species in the mix of the source and a pool.</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    It is based on the linear relationship of the given quantities (concentration)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    and delta-values (or alternatively the relative abundance x) which are measured</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    over time or across a spatial interval according to</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        delta_mix = delta_source + m * 1/c_mix</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">    where m is the slope relating the isotopic quantities of the pool (which mixes</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    with the sourse) by m = (delta_pool + delta_source)*c_pool.</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    The analysis is based on a linear regression of the inverse concentration</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">    data against the delta (or x)-values. The parameter of interest, the delta</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    (or relative_abundance, respectively) of the source quantity is the</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">    intercept of linear fit with the y-axis, or in other words, the absolute</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    value of the linear fit function.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    A plot of the results with data and linear trendline can be generate with the</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    method Keeling_plot() [in the module visualize].</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    Note that the approach is only applicable if</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        (i)  the isotopic composition of the unknown source is constant</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        (ii) the concentration and isotopic composition of the target compound</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">            is constant (over time or across space)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">            (i.e. in absence of contamination from the unknown source)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">    Input</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">    -----</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">        concentration : np.array, pd.dataframe</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">            total molecular mass/molar concentration of target substance</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">            at different locations (at a time) or at different times (at one location)</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        delta_mix : np.array, pd.dataframe (same length as c_mix), default None</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">            relative isotope ratio (delta-value) of target substance</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        relative_abundance : None or np.array, pd.dataframe (same length as c_mix), default None</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">            if not None it replaces delta_mix in the inverse estimation and plotting</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">            relative abundance of target substance</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        validate_indices: boolean, default True</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">            flag to run index validation (i.e. removal of nan and infinity values)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        verbose : Boolean, The default is False.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">           Set to True to get messages in the Console about the status of the run code.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        **kwargs : dict</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">            keywordarguments dictionary, e.g. for passing forward keywords to</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">            valid_indices()</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    -------</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        results : dict</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">            results of fitting, including:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">                * coefficients : array/list of lenght 2, where coefficients[0]</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">                    is the slope of the linear fit and coefficient[1] is the</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">                    intercept of linear fit with y-axis, reflecting delta</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">                    (or relative_abundance, respectively) of the source quantity</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">                * delta_C: np.array with isotope used for fitting - all samples</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">                    where non-zero values are available for delta_C and delta_H</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">                * delta_H: np.array with isotope used for fitting - all samples</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">                    where non-zero values are available for delta_C and delta_H</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;Keeling_regression()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="k">if</span> <span class="n">delta_mix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">delta_mix</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;delta&#39;</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="k">elif</span> <span class="n">relative_abundance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">relative_abundance</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;relative abundance&#39;</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;One of the quantities &#39;delta_mix&#39; or &#39;relative_abundance&#39; must be provided&quot;</span><span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="c1">### check length of data arrays and remove non-valid values (NaN, inf &amp; zero)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="k">if</span> <span class="n">validate_indices</span><span class="p">:</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">valid_indices</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>                                 <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>                                 <span class="n">remove_nan</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>                                 <span class="n">remove_infinity</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>                                 <span class="n">remove_zero</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>                                 <span class="p">)</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">concentration</span><span class="p">,</span><span class="n">y</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="c1">### perform linear regression</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">{}</span><span class="s2"> of the source quantity, being the intercept&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;of the linear fit, is identified with </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coefficients</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;______________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="n">results</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="n">concentration</span> <span class="o">=</span> <span class="n">data1</span><span class="p">,</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="n">delta</span> <span class="o">=</span> <span class="n">data2</span><span class="p">,</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="n">coefficients</span> <span class="o">=</span> <span class="n">coefficients</span><span class="p">,</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="p">)</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.reduction.stable_isotope_regression.Lambda_regression" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Lambda_regression</span><span class="p">(</span><span class="n">delta_C</span><span class="p">,</span> <span class="n">delta_H</span><span class="p">,</span> <span class="n">validate_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Performing linear regression to achieve Lambda value.</p>
<p>The Lambda values relates the δ13C versus δ2H signatures of a chemical
compound. Relative changes in the ratio can indicate the occurrence of
specific enzymatic degradation reactions.</p>
<p>The analysis is based on a linear regression of the hydrogen versus
carbon isotope signatures. The parameter of interest, the Lambda values
is the slope of the the linear trend line.</p>
<p>A plot of the results with data and linear trendline can be generate with the
method Lambda_plot() [in the module visualize].</p>
<h6 id="mibipret.analysis.reduction.stable_isotope_regression.Lambda_regression--input">Input</h6>
<div class="highlight"><pre><span></span><code>delta_C : np.array, pd.series
    relative isotope ratio (delta-value) of carbon of target molecule
delta_H : np.array, pd.series (same length as delta_C)
    relative isotope ratio (delta-value) of hydrogen of target molecule
validate_indices: boolean, default True
    flag to run index validation (i.e. removal of nan and infinity values)
verbose : Boolean, The default is False.
   Set to True to get messages in the Console about the status of the run code.
**kwargs : dict
    keywordarguments dictionary, e.g. for passing forward keywords to
    valid_indices()
</code></pre></div>
<h6 id="mibipret.analysis.reduction.stable_isotope_regression.Lambda_regression--returns">Returns</h6>
<div class="highlight"><pre><span></span><code>results : dict
    results of fitting, including:
        * coefficients : array/list of lenght 2, where coefficients[0]
            is the slope of the linear fit, reflecting the lambda values
            and coefficient[1] is the absolute value of the linear function
        * delta_C: np.array with isotope used for fitting - all samples
            where non-zero values are available for delta_C and delta_H
        * delta_H: np.array with isotope used for fitting - all samples
            where non-zero values are available for delta_C and delta_H
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/reduction/stable_isotope_regression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">Lambda_regression</span><span class="p">(</span><span class="n">delta_C</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>                      <span class="n">delta_H</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>                      <span class="n">validate_indices</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>                      <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>                      <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>                      <span class="p">):</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performing linear regression to achieve Lambda value.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    The Lambda values relates the δ13C versus δ2H signatures of a chemical</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    compound. Relative changes in the ratio can indicate the occurrence of</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    specific enzymatic degradation reactions.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    The analysis is based on a linear regression of the hydrogen versus</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    carbon isotope signatures. The parameter of interest, the Lambda values</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    is the slope of the the linear trend line.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    A plot of the results with data and linear trendline can be generate with the</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    method Lambda_plot() [in the module visualize].</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    Input</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    -----</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        delta_C : np.array, pd.series</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">            relative isotope ratio (delta-value) of carbon of target molecule</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        delta_H : np.array, pd.series (same length as delta_C)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">            relative isotope ratio (delta-value) of hydrogen of target molecule</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        validate_indices: boolean, default True</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            flag to run index validation (i.e. removal of nan and infinity values)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        verbose : Boolean, The default is False.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">           Set to True to get messages in the Console about the status of the run code.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        **kwargs : dict</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">            keywordarguments dictionary, e.g. for passing forward keywords to</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">            valid_indices()</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    -------</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        results : dict</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">            results of fitting, including:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">                * coefficients : array/list of lenght 2, where coefficients[0]</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">                    is the slope of the linear fit, reflecting the lambda values</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">                    and coefficient[1] is the absolute value of the linear function</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">                * delta_C: np.array with isotope used for fitting - all samples</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">                    where non-zero values are available for delta_C and delta_H</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">                * delta_H: np.array with isotope used for fitting - all samples</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">                    where non-zero values are available for delta_C and delta_H</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="c1">### check length of data arrays and remove non-valid values (NaN, inf &amp; zero)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;Lambda_regression()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="k">if</span> <span class="n">validate_indices</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">valid_indices</span><span class="p">(</span><span class="n">delta_C</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>                                     <span class="n">delta_H</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>                                     <span class="n">remove_nan</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>                                     <span class="n">remove_infinity</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>                                     <span class="n">remove_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>                                     <span class="p">)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">delta_C</span><span class="p">,</span><span class="n">delta_H</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="c1">### perform linear regression</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lambda value, being the slope of the linear fit is </span><span class="se">\n</span><span class="s2"> identified with </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coefficients</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;______________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">results</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">delta_C</span> <span class="o">=</span> <span class="n">data1</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="n">delta_H</span> <span class="o">=</span> <span class="n">data2</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="n">coefficients</span> <span class="o">=</span> <span class="n">coefficients</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="p">)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Rayleigh_fractionation</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">validate_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Performing Rayleigh fractionation analysis.</p>
<p>Rayleigh fractionation is a common application to characterize the removal
of a substance from a finite pool using stable isotopes. It is based on the
change in the isotopic composition of the pool due to different kinetics of
the change in lighter and heavier isotopes.</p>
<p>We follow the most simple approach assuming that the substance removal follows
first-order kinetics, where the rate coefficients for the lighter and heavier
isotopes of the substance differ due to kinetic isotope fractionation effects.
The isotopic composition of the remaining substance in the pool will change
over time, leading to the so-called Rayleigh fractionation.</p>
<p>The analysis is based on a linear regression of the log-transformed concentration
data against the delta-values. The parameter of interest, the kinetic
fractionation factor (epsilon or alpha -1) of the removal process is the slope
of the the linear trend line.</p>
<p>A plot of the results with data and linear trendline can be generate with the
method Rayleigh_fractionation_plot() [in the module visualize].</p>
<h6 id="mibipret.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation--input">Input</h6>
<div class="highlight"><pre><span></span><code>concentration : np.array, pd.dataframe
    total molecular mass/molar concentration of target substance
    at different locations (at a time) or at different times (at one location)
delta : np.array, pd.dataframe (same length as concentration)
    relative isotope ratio (delta-value) of target substance
validate_indices: boolean, default True
    flag to run index validation (i.e. removal of nan and infinity values)
verbose : Boolean, The default is False.
   Set to True to get messages in the Console about the status of the run code.
**kwargs : dict
    keywordarguments dictionary, e.g. for passing forward keywords to
    valid_indices()
</code></pre></div>
<h6 id="mibipret.analysis.reduction.stable_isotope_regression.Rayleigh_fractionation--returns">Returns</h6>
<div class="highlight"><pre><span></span><code>results : dict
    results of fitting, including:
        * coefficients : array/list of lenght 2, where coefficients[0]
            is the slope of the linear fit, reflecting the kinetic
            fractionation factor (epsilon or alpha -1) of the removal process
            and coefficient[1] is the absolute value of the linear function
        * delta_C: np.array with isotope used for fitting - all samples
            where non-zero values are available for delta_C and delta_H
        * delta_H: np.array with isotope used for fitting - all samples
            where non-zero values are available for delta_C and delta_H
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/reduction/stable_isotope_regression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="k">def</span><span class="w"> </span><span class="nf">Rayleigh_fractionation</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>                           <span class="n">delta</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>                           <span class="n">validate_indices</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>                           <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>                           <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                           <span class="p">):</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performing Rayleigh fractionation analysis.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    Rayleigh fractionation is a common application to characterize the removal</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    of a substance from a finite pool using stable isotopes. It is based on the</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">    change in the isotopic composition of the pool due to different kinetics of</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    the change in lighter and heavier isotopes.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    We follow the most simple approach assuming that the substance removal follows</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    first-order kinetics, where the rate coefficients for the lighter and heavier</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">    isotopes of the substance differ due to kinetic isotope fractionation effects.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    The isotopic composition of the remaining substance in the pool will change</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    over time, leading to the so-called Rayleigh fractionation.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    The analysis is based on a linear regression of the log-transformed concentration</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    data against the delta-values. The parameter of interest, the kinetic</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    fractionation factor (epsilon or alpha -1) of the removal process is the slope</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    of the the linear trend line.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    A plot of the results with data and linear trendline can be generate with the</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    method Rayleigh_fractionation_plot() [in the module visualize].</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    Input</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    -----</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        concentration : np.array, pd.dataframe</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">            total molecular mass/molar concentration of target substance</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">            at different locations (at a time) or at different times (at one location)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        delta : np.array, pd.dataframe (same length as concentration)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            relative isotope ratio (delta-value) of target substance</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        validate_indices: boolean, default True</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            flag to run index validation (i.e. removal of nan and infinity values)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        verbose : Boolean, The default is False.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">           Set to True to get messages in the Console about the status of the run code.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        **kwargs : dict</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            keywordarguments dictionary, e.g. for passing forward keywords to</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            valid_indices()</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    -------</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        results : dict</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            results of fitting, including:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">                * coefficients : array/list of lenght 2, where coefficients[0]</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">                    is the slope of the linear fit, reflecting the kinetic</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">                    fractionation factor (epsilon or alpha -1) of the removal process</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">                    and coefficient[1] is the absolute value of the linear function</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">                * delta_C: np.array with isotope used for fitting - all samples</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">                    where non-zero values are available for delta_C and delta_H</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">                * delta_H: np.array with isotope used for fitting - all samples</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">                    where non-zero values are available for delta_C and delta_H</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="c1">### check length of data arrays and remove non-valid values (NaN, inf &amp; zero)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;Rayleigh_fractionation()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="k">if</span> <span class="n">validate_indices</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">valid_indices</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                                 <span class="n">delta</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                                 <span class="n">remove_nan</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                                 <span class="n">remove_infinity</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                                 <span class="n">remove_zero</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                                 <span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">concentration</span><span class="p">,</span><span class="n">delta</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="c1">### perform linear regression</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">data1</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Concentration data provided is negative, but has to be positive.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data1</span><span class="p">),</span> <span class="n">data2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The kinetic fractionation factor (&#39;epsilon&#39; or &#39;alpha-1&#39;) of&quot;</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;the removal process, being the slope of the linear fit, is &quot;</span><span class="p">)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;identified with </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coefficients</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;______________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">results</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="n">concentration</span> <span class="o">=</span> <span class="n">data1</span><span class="p">,</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="n">delta</span> <span class="o">=</span> <span class="n">data2</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">coefficients</span> <span class="o">=</span> <span class="n">coefficients</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.reduction.stable_isotope_regression.extract_isotope_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_isotope_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">molecule</span><span class="p">,</span> <span class="n">name_13C</span><span class="o">=</span><span class="s1">&#39;delta_13C&#39;</span><span class="p">,</span> <span class="n">name_2H</span><span class="o">=</span><span class="s1">&#39;delta_2H&#39;</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Extracts isotope data from standardised input-dataframe.</p>
<h6 id="mibipret.analysis.reduction.stable_isotope_regression.extract_isotope_data--parameters">Parameters</h6>
<p>df : pd.dataframe
    numeric (observational) data
molecule : str
    name of contaminant molecule to extract isotope data for
name_13C : str, default &lsquo;delta_13C&rsquo; (standard name)
    name of C13 isotope to extract data for
name_2H : str, default &lsquo;delta_2H&rsquo; (standard name)
    name of deuterium isotope to extract data for</p>
<h6 id="mibipret.analysis.reduction.stable_isotope_regression.extract_isotope_data--returns">Returns</h6>
<p>C_data : np.array
    numeric isotope data
H_data : np.array
    numeric isotope data</p>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/reduction/stable_isotope_regression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="k">def</span><span class="w"> </span><span class="nf">extract_isotope_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>                         <span class="n">molecule</span><span class="p">,</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>                         <span class="n">name_13C</span> <span class="o">=</span> <span class="s1">&#39;delta_13C&#39;</span><span class="p">,</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                         <span class="n">name_2H</span> <span class="o">=</span> <span class="s1">&#39;delta_2H&#39;</span><span class="p">,</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>                         <span class="p">):</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts isotope data from standardised input-dataframe.</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">    df : pd.dataframe</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        numeric (observational) data</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">    molecule : str</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        name of contaminant molecule to extract isotope data for</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">    name_13C : str, default &#39;delta_13C&#39; (standard name)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        name of C13 isotope to extract data for</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">    name_2H : str, default &#39;delta_2H&#39; (standard name)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        name of deuterium isotope to extract data for</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">    -------</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">    C_data : np.array</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        numeric isotope data</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">    H_data : np.array</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        numeric isotope data</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="n">molecule_standard</span> <span class="o">=</span> <span class="n">names_contaminants</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>    <span class="n">isotope_13C</span> <span class="o">=</span> <span class="n">names_isotopes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name_13C</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>    <span class="n">isotope_2H</span> <span class="o">=</span> <span class="n">names_isotopes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name_2H</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="k">if</span> <span class="n">molecule_standard</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Contaminant (name) unknown: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">molecule</span><span class="p">))</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="k">if</span> <span class="n">isotope_13C</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Isotope (name) unknown: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_13C</span><span class="p">))</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="k">if</span> <span class="n">isotope_2H</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Isotope (name) unknown: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_2H</span><span class="p">))</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="n">name_C</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">isotope_13C</span><span class="p">,</span><span class="n">molecule_standard</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="n">name_H</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">isotope_2H</span><span class="p">,</span><span class="n">molecule_standard</span><span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="k">if</span> <span class="n">name_C</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No isotope data available for : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_C</span><span class="p">))</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="k">if</span> <span class="n">name_H</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No isotope data available for : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_H</span><span class="p">))</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="n">C_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">name_C</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="n">H_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">name_H</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="k">return</span> <span class="n">C_data</span><span class="p">,</span> <span class="n">H_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.reduction.stable_isotope_regression.valid_indices" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">valid_indices</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">remove_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_infinity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Identifies valid indices in two equaly long arrays and compresses both.</p>
<p>Optional numerical to remove from array are: nan, infinity and zero values.</p>
<h6 id="mibipret.analysis.reduction.stable_isotope_regression.valid_indices--parameters">Parameters</h6>
<p>data1 : np.array or pd.series
    numeric data
data2 : np.array or pd.series (same len/shape as data1)
    numeric data
remove_nan : boolean, default True
    flag to remove nan-values
remove_infinity : boolean, default True
    flag to remove infinity values
remove_zero : boolean, default False
    flag to remove zero values
**kwargs : dict
    keywordarguments dictionary</p>
<h6 id="mibipret.analysis.reduction.stable_isotope_regression.valid_indices--returns">Returns</h6>
<p>data1 : np.array or pd.series
    numeric data of reduced length where only data at valid indices is in
data2 : np.array or pd.series
    numeric data of reduced length where only data at valid indices is in</p>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/reduction/stable_isotope_regression.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="k">def</span><span class="w"> </span><span class="nf">valid_indices</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>                  <span class="n">data2</span><span class="p">,</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>                  <span class="n">remove_nan</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>                  <span class="n">remove_infinity</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>                  <span class="n">remove_zero</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>                  <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>                  <span class="p">):</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Identifies valid indices in two equaly long arrays and compresses both.</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    Optional numerical to remove from array are: nan, infinity and zero values.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    data1 : np.array or pd.series</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        numeric data</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">    data2 : np.array or pd.series (same len/shape as data1)</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        numeric data</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">    remove_nan : boolean, default True</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        flag to remove nan-values</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">    remove_infinity : boolean, default True</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        flag to remove infinity values</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">    remove_zero : boolean, default False</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        flag to remove zero values</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">    **kwargs : dict</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        keywordarguments dictionary</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    -------</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">    data1 : np.array or pd.series</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        numeric data of reduced length where only data at valid indices is in</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">    data2 : np.array or pd.series</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        numeric data of reduced length where only data at valid indices is in</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="k">if</span> <span class="n">data1</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">data2</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Shape of provided data must be identical.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="n">valid_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="k">if</span> <span class="n">remove_nan</span><span class="p">:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="n">valid_indices</span> <span class="o">*=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="k">if</span> <span class="n">remove_infinity</span><span class="p">:</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="n">valid_indices</span> <span class="o">*=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="k">if</span> <span class="n">remove_zero</span><span class="p">:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="n">valid_indices</span> <span class="o">*=</span> <span class="p">(</span><span class="n">data1</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="k">return</span> <span class="n">data1</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">],</span><span class="n">data2</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mibipret.analysis.sample" class="doc doc-heading">
            <code>sample</code>


</h3>

    <div class="doc doc-contents ">

        <p>mibipret module for data analysis performed on each sample.</p>








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h4 id="mibipret.analysis.sample.properties" class="doc doc-heading">
            <code>properties</code>


</h4>

    <div class="doc doc-contents ">

        <p>Properties for Natural Attenuation Screening.</p>
<p>File containing name specifications of quantities and parameters measured in
groundwater samples useful for biodegredation and bioremediation analysis</p>
<p>@author: A. Zech</p>








  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="mibipret.analysis.sample.screening_NA" class="doc doc-heading">
            <code>screening_NA</code>


</h4>

    <div class="doc doc-contents ">

        <p>Routines for calculating natural attenuation potential.</p>
<p>@author: alraune</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.sample.screening_NA.NA_traffic" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">NA_traffic</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Function evaluating if natural attenuation (NA) is ongoing.</p>
<p>Function to calculate electron balance, based on electron availability
calculated from concentrations of contaminant and electron acceptors.</p>
<h6 id="mibipret.analysis.sample.screening_NA.NA_traffic--input">Input</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    Ratio of electron availability
inplace: bool, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean
    verbose flag (default False)
</code></pre></div>
<h6 id="mibipret.analysis.sample.screening_NA.NA_traffic--output">Output</h6>
<div class="highlight"><pre><span></span><code>traffic : pd.Series
    Traffic light (decision) based on ratio of electron availability
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/sample/screening_NA.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="k">def</span><span class="w"> </span><span class="nf">NA_traffic</span><span class="p">(</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="p">):</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function evaluating if natural attenuation (NA) is ongoing.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    Function to calculate electron balance, based on electron availability</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">    calculated from concentrations of contaminant and electron acceptors.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    Input</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">    -----</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">            Ratio of electron availability</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        inplace: bool, default False</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            verbose flag (default False)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">    Output</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    ------</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        traffic : pd.Series</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">            Traffic light (decision) based on ratio of electron availability</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;NA_traffic()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="n">cols</span> <span class="o">=</span> <span class="n">check_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="k">if</span> <span class="n">names</span><span class="o">.</span><span class="n">name_e_balance</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="n">e_balance</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_e_balance</span><span class="p">]</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="n">e_balance</span> <span class="o">=</span> <span class="n">electron_balance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="c1"># raise ValueError(&quot;Electron balance not given in data.&quot;)</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="n">e_bal</span> <span class="o">=</span> <span class="n">e_balance</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="n">traffic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">e_bal</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="n">traffic</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">e_bal</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="n">NA_traffic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span><span class="n">names</span><span class="o">.</span><span class="n">name_na_traffic_light</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">traffic</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="n">e_balance</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_na_traffic_light</span><span class="p">]</span> <span class="o">=</span> <span class="n">NA_traffic</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Evaluation if natural attenuation (NA) is ongoing:&quot;</span><span class="p">)</span><span class="c1">#&quot; for {}&quot;.format(contaminant_group))</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Red light: Reduction is limited at </span><span class="si">{}</span><span class="s2"> out of </span><span class="si">{}</span><span class="s2"> locations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">traffic</span> <span class="o">==</span> <span class="s2">&quot;red&quot;</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">e_bal</span><span class="p">)))</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Green light: Reduction is limited at </span><span class="si">{}</span><span class="s2"> out of </span><span class="si">{}</span><span class="s2"> locations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">traffic</span> <span class="o">==</span> <span class="s2">&quot;green&quot;</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">e_bal</span><span class="p">)))</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yellow light: No decision possible at </span><span class="si">{}</span><span class="s2"> out of </span><span class="si">{}</span><span class="s2"> locations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">e_bal</span><span class="p">)),</span><span class="nb">len</span><span class="p">(</span><span class="n">e_bal</span><span class="p">)))</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="k">return</span> <span class="n">NA_traffic</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.sample.screening_NA.available_NP" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">available_NP</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Function calculating available nutrients.</p>
<p>Approximating the amount of hydrocarbons that can be degraded based
on the amount of nutrients (nitrogen and phosphate available)</p>
<h6 id="mibipret.analysis.sample.screening_NA.available_NP--input">Input</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    nitrate, nitrite and phosphate concentrations in [mg/l]
inplace: bool, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean
    verbose flag (default False)

Output
------
NP_avail: pd.Series
    The amount of nutrients for degrading contaminants
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/sample/screening_NA.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="k">def</span><span class="w"> </span><span class="nf">available_NP</span><span class="p">(</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="p">):</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function calculating available nutrients.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">    Approximating the amount of hydrocarbons that can be degraded based</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    on the amount of nutrients (nitrogen and phosphate available)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    Input</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    -----</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            nitrate, nitrite and phosphate concentrations in [mg/l]</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        inplace: bool, default False</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            verbose flag (default False)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        Output</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        ------</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        NP_avail: pd.Series</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">            The amount of nutrients for degrading contaminants</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;available_NP()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="n">cols</span> <span class="o">=</span> <span class="n">check_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="n">nutrient_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_nitrate</span><span class="p">,</span> <span class="n">names</span><span class="o">.</span><span class="n">name_nitrite</span><span class="p">,</span> <span class="n">names</span><span class="o">.</span><span class="n">name_phosphate</span><span class="p">]</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="n">list_nut_miss</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="k">for</span> <span class="n">nut</span> <span class="ow">in</span> <span class="n">nutrient_list</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="k">if</span> <span class="n">nut</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="n">list_nut_miss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nut</span><span class="p">)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_nut_miss</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Concentrations of nutrient(s) missing:&quot;</span><span class="p">,</span> <span class="n">list_nut_miss</span><span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="n">CNs</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_nitrate</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_nitrite</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mf">39.</span> <span class="o">/</span> <span class="mf">4.5</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">CPs</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_phosphate</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mf">39.</span> <span class="o">/</span> <span class="mf">1.</span><span class="p">)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="n">NP_avail</span> <span class="o">=</span><span class="n">CNs</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">CPs</span><span class="p">,</span> <span class="nb">min</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="n">NP_avail</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">name_NP_avail</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_NP_avail</span><span class="p">]</span> <span class="o">=</span> <span class="n">NP_avail</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total NP available is:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">NP_avail</span><span class="p">))</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="k">return</span> <span class="n">NP_avail</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.sample.screening_NA.check_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Checking data on correct format.</p>
<h6 id="mibipret.analysis.sample.screening_NA.check_data--input">Input</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    concentration values of quantities
</code></pre></div>
<h6 id="mibipret.analysis.sample.screening_NA.check_data--output">Output</h6>
<div class="highlight"><pre><span></span><code>cols: list
List of column names
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/sample/screening_NA.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checking data on correct format.</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">    Input</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">    -----</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">            concentration values of quantities</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">    Output</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">    ------</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">        cols: list</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">        List of column names</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>        <span class="n">cols</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Calculation of not possible with given data. </span><span class="se">\</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="s2">                          Data has to be a panda-DataFrame or Series </span><span class="se">\</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="s2">                          but is given as type </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>    <span class="k">return</span> <span class="n">cols</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.sample.screening_NA.electron_balance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">electron_balance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Decision if natural attenuation is taking place.</p>
<p>Function to calculate electron balance, based on electron availability
calculated from concentrations of contaminant and electron acceptors</p>
<h6 id="mibipret.analysis.sample.screening_NA.electron_balance--input">Input</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    tabular data containinng &quot;total_reductors&quot; and &quot;total_oxidators&quot;
        -total amount of electrons available for reduction [mmol e-/l]
        -total amount of electrons needed for oxidation [mmol e-/l]
inplace: bool, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean
    verbose flag (default False)
</code></pre></div>
<h6 id="mibipret.analysis.sample.screening_NA.electron_balance--output">Output</h6>
<div class="highlight"><pre><span></span><code>e_bal : pd.Series
    Ratio of electron availability: electrons available for reduction
    devided by electrons needed for oxidation
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/sample/screening_NA.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="k">def</span><span class="w"> </span><span class="nf">electron_balance</span><span class="p">(</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="p">):</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Decision if natural attenuation is taking place.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">    Function to calculate electron balance, based on electron availability</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    calculated from concentrations of contaminant and electron acceptors</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    Input</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    -----</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">            tabular data containinng &quot;total_reductors&quot; and &quot;total_oxidators&quot;</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">                -total amount of electrons available for reduction [mmol e-/l]</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">                -total amount of electrons needed for oxidation [mmol e-/l]</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        inplace: bool, default False</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">            verbose flag (default False)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    Output</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    ------</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        e_bal : pd.Series</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">            Ratio of electron availability: electrons available for reduction</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            devided by electrons needed for oxidation</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;electron_balance()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="n">cols</span> <span class="o">=</span> <span class="n">check_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="k">if</span> <span class="n">names</span><span class="o">.</span><span class="n">name_total_reductors</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="n">tot_reduct</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_total_reductors</span><span class="p">]</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">tot_reduct</span> <span class="o">=</span> <span class="n">reductors</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="c1"># raise ValueError(&quot;Total amount of oxidators not given in data.&quot;)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="k">if</span> <span class="n">names</span><span class="o">.</span><span class="n">name_total_oxidators</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">tot_oxi</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_total_oxidators</span><span class="p">]</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="n">tot_oxi</span> <span class="o">=</span> <span class="n">oxidators</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="c1"># raise ValueError(&quot;Total amount of reductors not given in data.&quot;)</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="n">e_bal</span> <span class="o">=</span> <span class="n">tot_reduct</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">tot_oxi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="n">e_bal</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">name_e_balance</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_e_balance</span><span class="p">]</span> <span class="o">=</span> <span class="n">e_bal</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Electron balance e_red/e_cont is:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e_bal</span><span class="p">))</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">return</span> <span class="n">e_bal</span> <span class="c1">#,decision</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.sample.screening_NA.oxidators" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">oxidators</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contaminant_group</span><span class="o">=</span><span class="s1">&#39;BTEXIIN&#39;</span><span class="p">,</span> <span class="n">nutrient</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the amount of electron oxidators [mmol e-/l].</p>
<p>Calculate the amount of electron oxidators in [mmol e-/l]
based on concentrations of contaminants, stiochiometric ratios of reactions,
contaminant properties (e.g. molecular masses in [mg/mmol])</p>
<p>alternatively: based on nitrogen and phosphate availability</p>
<h6 id="mibipret.analysis.sample.screening_NA.oxidators--input">Input</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    Contaminant contentrations in [ug/l], i.e. microgram per liter
    if nutrient is True, data also needs to contain concentrations
    of Nitrate, Nitrite and Phosphate
contaminant_group: str
    Short name for group of contaminants to use
    default is &#39;BTEXIIN&#39; (for benzene, toluene, ethylbenzene, xylene,
                          indene, indane and naphthaline)
nutrient: Boolean
    flag to include oxidator availability based on nutrient supply
    calls internally routine &quot;available_NP()&quot; with data
inplace: bool, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean
    verbose flag (default False)
</code></pre></div>
<h6 id="mibipret.analysis.sample.screening_NA.oxidators--output">Output</h6>
<div class="highlight"><pre><span></span><code>tot_oxi: pd.Series
    Total amount of electrons oxidators in [mmol e-/l]
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/sample/screening_NA.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="k">def</span><span class="w"> </span><span class="nf">oxidators</span><span class="p">(</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">contaminant_group</span> <span class="o">=</span> <span class="s2">&quot;BTEXIIN&quot;</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="n">nutrient</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="p">):</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the amount of electron oxidators [mmol e-/l].</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    Calculate the amount of electron oxidators in [mmol e-/l]</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    based on concentrations of contaminants, stiochiometric ratios of reactions,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    contaminant properties (e.g. molecular masses in [mg/mmol])</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    alternatively: based on nitrogen and phosphate availability</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    Input</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">    -----</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            Contaminant contentrations in [ug/l], i.e. microgram per liter</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            if nutrient is True, data also needs to contain concentrations</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">            of Nitrate, Nitrite and Phosphate</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        contaminant_group: str</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            Short name for group of contaminants to use</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            default is &#39;BTEXIIN&#39; (for benzene, toluene, ethylbenzene, xylene,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">                                  indene, indane and naphthaline)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        nutrient: Boolean</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">            flag to include oxidator availability based on nutrient supply</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            calls internally routine &quot;available_NP()&quot; with data</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        inplace: bool, default False</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">            verbose flag (default False)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    Output</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    ------</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        tot_oxi: pd.Series</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">            Total amount of electrons oxidators in [mmol e-/l]</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;oxidators()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">tot_oxi</span> <span class="o">=</span> <span class="mf">0.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">cols</span> <span class="o">=</span> <span class="n">check_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="k">if</span> <span class="n">nutrient</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">NP_avail</span> <span class="o">=</span> <span class="n">available_NP</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">eas</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">contaminants</span><span class="p">[</span><span class="n">contaminant_group</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">name_o_xylene</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">name_pm_xylene</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">):</span> <span class="c1"># and (names.name_xylene in cols):</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="n">eas</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">name_xylene</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">eas</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="k">if</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>                <span class="c1"># tot_oxi += data[cont]*0.001/properties[cont][&#39;molecular_mass&#39;]*</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>                    <span class="c1">#properties[cont][&#39;factor_stoichiometry&#39;]</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>                <span class="k">if</span> <span class="n">nutrient</span><span class="p">:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>                    <span class="n">nut_avail</span> <span class="o">=</span> <span class="mf">1000.</span><span class="o">*</span><span class="n">NP_avail</span><span class="o">*</span><span class="n">properties</span><span class="p">[</span><span class="n">cont</span><span class="p">][</span><span class="s1">&#39;molecular_mass&#39;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">properties</span><span class="p">[</span><span class="n">cont</span><span class="p">][</span><span class="s1">&#39;cs&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">12.</span><span class="p">)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>                    <span class="n">c_min</span> <span class="o">=</span> <span class="n">nut_avail</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">cont</span><span class="p">],</span> <span class="nb">min</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># mass concentration in ug/l</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>                    <span class="n">c_min</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>                <span class="n">cm_cont</span> <span class="o">=</span> <span class="n">c_min</span><span class="o">*</span> <span class="mf">0.001</span><span class="o">/</span><span class="n">properties</span><span class="p">[</span><span class="n">cont</span><span class="p">][</span><span class="s1">&#39;molecular_mass&#39;</span><span class="p">]</span> <span class="c1"># molar concentration in mmol/l</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>                <span class="n">tot_oxi</span> <span class="o">+=</span> <span class="n">cm_cont</span> <span class="o">*</span>  <span class="n">properties</span><span class="p">[</span><span class="n">cont</span><span class="p">][</span><span class="s1">&#39;factor_stoichiometry&#39;</span><span class="p">]</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: No data on </span><span class="si">{}</span><span class="s2"> given, zero concentration assumed.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cont</span><span class="p">))</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;group of contaminant (&#39;contaminant_group&#39;) not defined: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">contaminant_group</span><span class="p">))</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data not in standardized format. Run &#39;standardize()&#39; first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="c1"># if isinstance(tot_oxi, float):</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="c1">#     print(&quot;\nWARNING: No data on contaminant concentrations given.&quot;)</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="c1">#     print(&#39;________________________________________________________________&#39;)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="c1">#     tot_oxi = False</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tot_oxi</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">tot_oxi</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">name_total_oxidators</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total amount of oxidators per well in [mmol e-/l] is:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tot_oxi</span><span class="p">))</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data on oxidators or only zero concentrations given.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_total_oxidators</span><span class="p">]</span> <span class="o">=</span> <span class="n">tot_oxi</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="k">return</span> <span class="n">tot_oxi</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.sample.screening_NA.reductors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reductors</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ea_group</span><span class="o">=</span><span class="s1">&#39;ONS&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the amount of electron reductors [mmol e-/l].</p>
<p>making use of imported molecular mass values for quantities in [mg/mmol]</p>
<h6 id="mibipret.analysis.sample.screening_NA.reductors--input">Input</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    concentration values of electron acceptors in [mg/l]
ea_group: str
    Short name for group of electron acceptors to use
    default is &#39;ONS&#39; (for oxygen, nitrate, and sulfate)
inplace: bool, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean
    verbose flag (default False)
</code></pre></div>
<h6 id="mibipret.analysis.sample.screening_NA.reductors--output">Output</h6>
<div class="highlight"><pre><span></span><code>tot_reduct: pd.Series
Total amount of electrons needed for reduction in [mmol e-/l]
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/sample/screening_NA.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="k">def</span><span class="w"> </span><span class="nf">reductors</span><span class="p">(</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">ea_group</span> <span class="o">=</span> <span class="s1">&#39;ONS&#39;</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="p">):</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the amount of electron reductors [mmol e-/l].</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    making use of imported molecular mass values for quantities in [mg/mmol]</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Input</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    -----</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">            concentration values of electron acceptors in [mg/l]</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        ea_group: str</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">            Short name for group of electron acceptors to use</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">            default is &#39;ONS&#39; (for oxygen, nitrate, and sulfate)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        inplace: bool, default False</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">            verbose flag (default False)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    Output</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    ------</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        tot_reduct: pd.Series</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        Total amount of electrons needed for reduction in [mmol e-/l]</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;reductors()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">tot_reduct</span> <span class="o">=</span> <span class="mf">0.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">cols</span><span class="o">=</span> <span class="n">check_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="k">for</span> <span class="n">ea</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">electron_acceptors</span><span class="p">[</span><span class="n">ea_group</span><span class="p">]:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>            <span class="k">if</span> <span class="n">ea</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>                <span class="n">tot_reduct</span> <span class="o">+=</span> <span class="n">properties</span><span class="p">[</span><span class="n">ea</span><span class="p">][</span><span class="s1">&#39;factor_stoichiometry&#39;</span><span class="p">]</span><span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="n">ea</span><span class="p">]</span><span class="o">/</span><span class="n">properties</span><span class="p">[</span><span class="n">ea</span><span class="p">][</span><span class="s1">&#39;molecular_mass&#39;</span><span class="p">]</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>                <span class="c1">#     pd.to_numeric(data[ea]) / properties[ea][&#39;molecular_mass&#39;]</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: No data on </span><span class="si">{}</span><span class="s2"> given, zero concentration assumed.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ea</span><span class="p">))</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Group of electron acceptors (&#39;ea_group&#39;) not defined: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ea_group</span><span class="p">))</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data not in standardized format. Run &#39;standardize()&#39; first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tot_reduct</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="n">tot_reduct</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">name_total_reductors</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total amount of electron reductors per well in [mmol e-/l] is:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tot_reduct</span><span class="p">))</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data on electron acceptors or only zero concentrations given.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="c1"># if isinstance(tot_reduct, float) and tot_reduct &lt;= 0.:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="c1">#     print(&quot;\nWARNING: No data on electron acceptor concentrations given.&quot;)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="c1">#     tot_reduct = False</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_total_reductors</span><span class="p">]</span> <span class="o">=</span> <span class="n">tot_reduct</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="k">return</span> <span class="n">tot_reduct</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.sample.screening_NA.screening_NA" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">screening_NA</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ea_group</span><span class="o">=</span><span class="s1">&#39;ONS&#39;</span><span class="p">,</span> <span class="n">contaminant_group</span><span class="o">=</span><span class="s1">&#39;BTEXIIN&#39;</span><span class="p">,</span> <span class="n">nutrient</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the amount of electron reductors [mmol e-/l].</p>
<p>making use of imported molecular mass values for quantities in [mg/mmol]</p>
<h6 id="mibipret.analysis.sample.screening_NA.screening_NA--input">Input</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    Concentration values of
        - electron acceptors in [mg/l]
        - contaminants in [ug/l]
        - nutrients (Nitrate, Nitrite and Phosphate) if nutrient is True
ea_group: str, default &#39;ONS&#39;
    Short name for group of electron acceptors to use
    &#39;ONS&#39; stands for oxygen, nitrate, sulfate and ironII
contaminant_group: str, default &#39;BTEXIIN&#39;
    Short name for group of contaminants to use
    &#39;BTEXIIN&#39; stands for benzene, toluene, ethylbenzene, xylene,
                           indene, indane and naphthaline
nutrient: Boolean, default False
    flag to include oxidator availability based on nutrient supply
    calls internally routine &quot;available_NP()&quot; with data
inplace: bool, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean, default False
    verbose flag
</code></pre></div>
<h6 id="mibipret.analysis.sample.screening_NA.screening_NA--output">Output</h6>
<div class="highlight"><pre><span></span><code>na_data: pd.DataFrame
    Tabular data with all quantities of NA screening listed per sample
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/sample/screening_NA.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="k">def</span><span class="w"> </span><span class="nf">screening_NA</span><span class="p">(</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>    <span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="n">ea_group</span> <span class="o">=</span> <span class="s1">&#39;ONS&#39;</span><span class="p">,</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>    <span class="n">contaminant_group</span> <span class="o">=</span> <span class="s2">&quot;BTEXIIN&quot;</span><span class="p">,</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>    <span class="n">nutrient</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>    <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>    <span class="p">):</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the amount of electron reductors [mmol e-/l].</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">    making use of imported molecular mass values for quantities in [mg/mmol]</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">    Input</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">    -----</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">            Concentration values of</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">                - electron acceptors in [mg/l]</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">                - contaminants in [ug/l]</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">                - nutrients (Nitrate, Nitrite and Phosphate) if nutrient is True</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">        ea_group: str, default &#39;ONS&#39;</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">            Short name for group of electron acceptors to use</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">            &#39;ONS&#39; stands for oxygen, nitrate, sulfate and ironII</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        contaminant_group: str, default &#39;BTEXIIN&#39;</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">            Short name for group of contaminants to use</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">            &#39;BTEXIIN&#39; stands for benzene, toluene, ethylbenzene, xylene,</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">                                   indene, indane and naphthaline</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">        nutrient: Boolean, default False</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">            flag to include oxidator availability based on nutrient supply</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">            calls internally routine &quot;available_NP()&quot; with data</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">        inplace: bool, default False</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        verbose: Boolean, default False</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">            verbose flag</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">    Output</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">    ------</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">        na_data: pd.DataFrame</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">            Tabular data with all quantities of NA screening listed per sample</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;screening_NA()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Runs all checks on data: column names, units and values&quot;</span><span class="p">)</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>    <span class="n">check_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>    <span class="n">tot_reduct</span> <span class="o">=</span> <span class="n">reductors</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                            <span class="n">ea_group</span> <span class="o">=</span> <span class="n">ea_group</span><span class="p">,</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>                            <span class="n">inplace</span> <span class="o">=</span> <span class="n">inplace</span><span class="p">,</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>                            <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>    <span class="n">tot_oxi</span> <span class="o">=</span> <span class="n">oxidators</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>                        <span class="n">contaminant_group</span> <span class="o">=</span> <span class="n">contaminant_group</span><span class="p">,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>                        <span class="n">nutrient</span> <span class="o">=</span> <span class="n">nutrient</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>                        <span class="n">inplace</span> <span class="o">=</span> <span class="n">inplace</span><span class="p">,</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>                        <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>    <span class="n">e_bal</span> <span class="o">=</span> <span class="n">electron_balance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>                             <span class="n">inplace</span> <span class="o">=</span> <span class="n">inplace</span><span class="p">,</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>                             <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="n">na_traffic</span> <span class="o">=</span> <span class="n">NA_traffic</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>                            <span class="n">contaminant_group</span> <span class="o">=</span> <span class="n">contaminant_group</span><span class="p">,</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>                            <span class="n">inplace</span> <span class="o">=</span> <span class="n">inplace</span><span class="p">,</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>                            <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>    <span class="n">tot_cont</span> <span class="o">=</span> <span class="n">total_contaminant_concentration</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>                                               <span class="n">contaminant_group</span> <span class="o">=</span> <span class="n">contaminant_group</span><span class="p">,</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>                                               <span class="n">inplace</span> <span class="o">=</span> <span class="n">inplace</span><span class="p">,</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>                                               <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>    <span class="n">na_data</span> <span class="o">=</span> <span class="n">thresholds_for_intervention</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>                                          <span class="n">contaminant_group</span> <span class="o">=</span> <span class="n">contaminant_group</span><span class="p">,</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>                                          <span class="n">inplace</span> <span class="o">=</span> <span class="n">inplace</span><span class="p">,</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>                                          <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>    <span class="k">if</span> <span class="n">inplace</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>        <span class="k">for</span> <span class="n">add</span> <span class="ow">in</span> <span class="p">[</span><span class="n">tot_cont</span><span class="p">,</span><span class="n">na_traffic</span><span class="p">,</span><span class="n">e_bal</span><span class="p">,</span><span class="n">tot_oxi</span><span class="p">,</span><span class="n">tot_reduct</span><span class="p">]:</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>            <span class="n">na_data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">add</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="k">if</span> <span class="n">nutrient</span><span class="p">:</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>            <span class="n">NP_avail</span> <span class="o">=</span> <span class="n">available_NP</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>            <span class="n">na_data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">NP_avail</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">NP_avail</span><span class="p">)</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>    <span class="k">return</span> <span class="n">na_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.sample.screening_NA.thresholds_for_intervention" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">thresholds_for_intervention</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contaminant_group</span><span class="o">=</span><span class="s1">&#39;BTEXIIN&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Function to evalute intervention threshold exceedance.</p>
<div class="highlight"><pre><span></span><code>Determines which contaminants exceed concentration thresholds set by
the Dutch government for intervention.
</code></pre></div>
<h6 id="mibipret.analysis.sample.screening_NA.thresholds_for_intervention--input">Input</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    Contaminant contentrations in [ug/l], i.e. microgram per liter
contaminant_group: str
    Short name for group of contaminants to use
    default is &#39;BTEXIIN&#39; (for benzene, toluene, ethylbenzene, xylene,
                          indene, indane and naphthaline)
inplace: bool, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean, default False
    verbose flag
</code></pre></div>
<h6 id="mibipret.analysis.sample.screening_NA.thresholds_for_intervention--output">Output</h6>
<div class="highlight"><pre><span></span><code>intervention: pd.DataFrame
DataFrame of similar format as input data with well specification and
three columns on intervention threshold exceedance analysis:
    - traffic light if well requires intervention
    - number of contaminants exceeding the intervention value
    - list of contaminants above the threshold of intervention
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/sample/screening_NA.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="k">def</span><span class="w"> </span><span class="nf">thresholds_for_intervention</span><span class="p">(</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="n">contaminant_group</span> <span class="o">=</span> <span class="s2">&quot;BTEXIIN&quot;</span><span class="p">,</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>        <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="p">):</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to evalute intervention threshold exceedance.</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">        Determines which contaminants exceed concentration thresholds set by</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        the Dutch government for intervention.</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">    Input</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">    -----</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">            Contaminant contentrations in [ug/l], i.e. microgram per liter</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">        contaminant_group: str</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">            Short name for group of contaminants to use</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">            default is &#39;BTEXIIN&#39; (for benzene, toluene, ethylbenzene, xylene,</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">                                  indene, indane and naphthaline)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">        inplace: bool, default False</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">        verbose: Boolean, default False</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">            verbose flag</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">    Output</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">    ------</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">        intervention: pd.DataFrame</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">        DataFrame of similar format as input data with well specification and</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">        three columns on intervention threshold exceedance analysis:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">            - traffic light if well requires intervention</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">            - number of contaminants exceeding the intervention value</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">            - list of contaminants above the threshold of intervention</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;thresholds_for_intervention()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="n">cols</span><span class="o">=</span> <span class="n">check_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>        <span class="n">na_intervention</span> <span class="o">=</span> <span class="n">data</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="n">na_intervention</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_sample</span><span class="p">,</span><span class="n">names</span><span class="o">.</span><span class="n">name_observation_well</span><span class="p">])</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="n">traffic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="n">intervention</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="n">eas</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">contaminants</span><span class="p">[</span><span class="n">contaminant_group</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">name_o_xylene</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">name_pm_xylene</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">):</span> <span class="c1"># and (names.name_xylene in cols):</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>            <span class="n">eas</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">name_xylene</span><span class="p">)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>        <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">eas</span><span class="p">:</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="k">if</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>                <span class="n">th_value</span> <span class="o">=</span> <span class="n">properties</span><span class="p">[</span><span class="n">cont</span><span class="p">][</span><span class="s1">&#39;thresholds_for_intervention_NL&#39;</span><span class="p">]</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>                <span class="n">traffic</span> <span class="o">+=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="n">th_value</span><span class="p">)</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">th_value</span><span class="p">:</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>                        <span class="n">intervention</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: No data on </span><span class="si">{}</span><span class="s2"> given, zero concentration assumed.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cont</span><span class="p">))</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="n">traffic_light</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">traffic</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="n">traffic_light</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">traffic</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="n">na_intervention</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_intervention_traffic</span><span class="p">]</span> <span class="o">=</span> <span class="n">traffic_light</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">na_intervention</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_intervention_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">traffic</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="n">na_intervention</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_intervention_contaminants</span><span class="p">]</span> <span class="o">=</span> <span class="n">intervention</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Evaluation of contaminant concentrations exceeding intervention values for </span><span class="si">{}</span><span class="s2">:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>                <span class="n">contaminant_group</span><span class="p">))</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------------------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Red light: Intervention values exceeded for </span><span class="si">{}</span><span class="s2"> out of </span><span class="si">{}</span><span class="s2"> locations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>                <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">traffic</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">),</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;green light: Concentrations below intervention values at </span><span class="si">{}</span><span class="s2"> out of </span><span class="si">{}</span><span class="s2"> locations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>                <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">traffic</span> <span class="o">==</span> <span class="mi">0</span><span class="p">),</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yellow light: No decision possible at </span><span class="si">{}</span><span class="s2"> out of </span><span class="si">{}</span><span class="s2"> locations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>                <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">traffic</span><span class="p">)),</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Group of contaminant (&#39;contaminant_group&#39;) not defined: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">contaminant_group</span><span class="p">))</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data not in standardized format. Run &#39;standardize()&#39; first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="k">return</span> <span class="n">na_intervention</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="mibipret.analysis.sample.screening_NA.total_contaminant_concentration" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_contaminant_concentration</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contaminant_group</span><span class="o">=</span><span class="s1">&#39;BTEXIIN&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Function to calculate total concentration of contaminants.</p>
<h6 id="mibipret.analysis.sample.screening_NA.total_contaminant_concentration--input">Input</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    Contaminant contentrations in [ug/l], i.e. microgram per liter
contaminant_group: str
    Short name for group of contaminants to use
    default is &#39;BTEXIIN&#39; (for benzene, toluene, ethylbenzene, xylene,
                          indene, indane and naphthaline)
inplace: bool, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean
    verbose flag (default False)
</code></pre></div>
<h6 id="mibipret.analysis.sample.screening_NA.total_contaminant_concentration--output">Output</h6>
<div class="highlight"><pre><span></span><code>tot_conc: pd.Series
    Total concentration of contaminants in [ug/l]
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/analysis/sample/screening_NA.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="k">def</span><span class="w"> </span><span class="nf">total_contaminant_concentration</span><span class="p">(</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="n">contaminant_group</span> <span class="o">=</span> <span class="s2">&quot;BTEXIIN&quot;</span><span class="p">,</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="p">):</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to calculate total concentration of contaminants.</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">    Input</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">    -----</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">            Contaminant contentrations in [ug/l], i.e. microgram per liter</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        contaminant_group: str</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">            Short name for group of contaminants to use</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">            default is &#39;BTEXIIN&#39; (for benzene, toluene, ethylbenzene, xylene,</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">                                  indene, indane and naphthaline)</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        inplace: bool, default False</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">            verbose flag (default False)</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">    Output</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    ------</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        tot_conc: pd.Series</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">            Total concentration of contaminants in [ug/l]</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;total_contaminant_concentration()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="n">tot_conc</span> <span class="o">=</span> <span class="mf">0.</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="n">cols</span> <span class="o">=</span> <span class="n">check_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="n">eas</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">contaminants</span><span class="p">[</span><span class="n">contaminant_group</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">name_o_xylene</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">name_pm_xylene</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">):</span> <span class="c1"># and (names.name_xylene in cols):</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="n">eas</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">name_xylene</span><span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">eas</span><span class="p">:</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="k">if</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>                <span class="n">tot_conc</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="c1"># mass concentration in ug/l</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: No data on </span><span class="si">{}</span><span class="s2"> given, zero concentration assumed.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cont</span><span class="p">))</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Group of contaminant (&#39;contaminant_group&#39;) not defined: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">contaminant_group</span><span class="p">))</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data not in standardized format. Run &#39;standardize()&#39; first.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>    <span class="c1"># if isinstance(tot_conc, float):</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="c1">#     print(&quot;\nWARNING: No data on contaminant concentrations given.&quot;)</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>    <span class="c1">#     print(&#39;________________________________________________________________&#39;)</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="c1">#     tot_conc = False</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tot_conc</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="n">tot_conc</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">name_total_contaminants</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total concentration of </span><span class="si">{}</span><span class="s2"> in [ug/l] is:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">contaminant_group</span><span class="p">,</span><span class="n">tot_conc</span><span class="p">))</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data on contaminants or only zero concentrations given.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_total_contaminants</span><span class="p">]</span> <span class="o">=</span> <span class="n">tot_conc</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="k">return</span> <span class="n">tot_conc</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="mibipret.data" class="doc doc-heading">
            <code>data</code>


</h2>

    <div class="doc doc-contents ">

        <p>mibipret module for data handling.</p>








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h3 id="mibipret.data.check_data" class="doc doc-heading">
            <code>check_data</code>


</h3>

    <div class="doc doc-contents ">

        <p>Functions for data handling and standardization.</p>
<p>@author: Alraune Zech</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mibipret.data.check_data.check_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_columns</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">check_metabolites</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">standardize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reduce</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function checking names of columns of data frame.</p>
<p>Function that looks at the column names and links it to standard names.
Optionally, it renames identified column names to the standard names of the model.</p>
        <hr />
<div class="highlight"><pre><span></span><code>data_frame: pd.DataFrame
    dataframe with the measurements
check_metabolites: Boolean, default False
    Whether to also check on metabolite names
standardize: Boolean, default False
    Whether to standardize identified column names
reduce: Boolean, default False
    Whether to reduce data to known quantities
verbose: Boolean, default True
    verbosity flag
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>tuple: three list containing names of
        list with identitied quantities in data (but not standardized names)
        list with unknown quantities in data (not in list of standardized names)
        list with standard names of identified quantities
</code></pre></div>
<h6 id="mibipret.data.check_data.check_columns--raises">Raises:</h6>
<p>None (yet).</p>
<h6 id="mibipret.data.check_data.check_columns--example">Example:</h6>
<p>Todo&rsquo;s:
    - complete list of potential contaminants, environmental factors
    - add name check for metabolites?</p>

            <details class="quote">
              <summary>Source code in <code>mibipret/data/check_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_columns</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>                  <span class="n">check_metabolites</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>                  <span class="n">standardize</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>                  <span class="n">reduce</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                  <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function checking names of columns of data frame.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    Function that looks at the column names and links it to standard names.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    Optionally, it renames identified column names to the standard names of the model.</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    -------</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        data_frame: pd.DataFrame</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            dataframe with the measurements</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        check_metabolites: Boolean, default False</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">            Whether to also check on metabolite names</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        standardize: Boolean, default False</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">            Whether to standardize identified column names</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        reduce: Boolean, default False</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            Whether to reduce data to known quantities</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        verbose: Boolean, default True</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">            verbosity flag</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">    -------</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        tuple: three list containing names of</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">                list with identitied quantities in data (but not standardized names)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">                list with unknown quantities in data (not in list of standardized names)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">                list with standard names of identified quantities</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">    -------</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    None (yet).</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    -------</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    Todo&#39;s:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        - complete list of potential contaminants, environmental factors</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        - add name check for metabolites?</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;check_columns()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                                <span class="n">sample_name_to_index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                                <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">results</span> <span class="o">=</span> <span class="n">standard_names</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>                             <span class="n">standardize</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>                             <span class="n">reduce</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                             <span class="n">check_metabolites</span> <span class="o">=</span> <span class="n">check_metabolites</span><span class="p">,</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>                             <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>                             <span class="p">)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="n">column_names_standard</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="n">column_names_known</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="n">column_names_unknown</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="n">column_names_transform</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="k">if</span> <span class="n">standardize</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">column_names_transform</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="k">if</span> <span class="n">reduce</span><span class="p">:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="n">column_names_unknown</span><span class="p">,</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> quantities identified in provided data.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">column_names_known</span><span class="p">)))</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;List of names with standard names:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">column_names_known</span><span class="p">):</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="s2">&quot; --&gt; &quot;</span><span class="p">,</span><span class="n">column_names_standard</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="k">if</span> <span class="n">standardize</span><span class="p">:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Identified column names have been standardized&quot;</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Renaming can be done by setting keyword &#39;standardize&#39; to True.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> quantities have not been identified in provided data:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">column_names_unknown</span><span class="p">)))</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">column_names_unknown</span><span class="p">):</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="k">if</span> <span class="n">reduce</span><span class="p">:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not identified quantities have been removed from data frame&quot;</span><span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Reduction to known quantities can be done by setting keyword &#39;reduce&#39; to True.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">column_names_known</span><span class="p">,</span><span class="n">column_names_unknown</span><span class="p">,</span><span class="n">column_names_standard</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibipret.data.check_data.check_data_frame" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">sample_name_to_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checking data on correct format.</p>
<p>Tests if provided data is a pandas data frame and provides column names.
Optionally it sets the sample name as index.</p>
<h6 id="mibipret.data.check_data.check_data_frame--input">Input</h6>
<div class="highlight"><pre><span></span><code>data_frame: pd.DataFrame
    quantities for data analysis given per sample
sample_name_to_index:  Boolean, default False
    Whether to set the sample name to the index of the DataFrame
inplace: Boolean, default False
    Whether to modify the DataFrame rather than creating a new one.
</code></pre></div>
<h6 id="mibipret.data.check_data.check_data_frame--output">Output</h6>
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    copy of given dataframe with index set to sample name
cols: list
    List of column names
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/data/check_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>                     <span class="n">sample_name_to_index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>                     <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>                     <span class="p">):</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checking data on correct format.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">    Tests if provided data is a pandas data frame and provides column names.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    Optionally it sets the sample name as index.</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    Input</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    -----</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        data_frame: pd.DataFrame</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            quantities for data analysis given per sample</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        sample_name_to_index:  Boolean, default False</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            Whether to set the sample name to the index of the DataFrame</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        inplace: Boolean, default False</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    Output</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    ------</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            copy of given dataframe with index set to sample name</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        cols: list</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            List of column names</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data has to be a panda-DataFrame or Series </span><span class="se">\</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="s2">                          but is given as type </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data_frame</span><span class="p">)))</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="k">if</span> <span class="n">inplace</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data_frame</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data_frame</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="k">if</span> <span class="n">sample_name_to_index</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="k">if</span> <span class="n">names</span><span class="o">.</span><span class="n">name_sample</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: No sample name provided for making index. Consider standardizing data first&quot;</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">name_sample</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="n">cols</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">cols</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibipret.data.check_data.check_units" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_units</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">check_metabolites</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function to check the units of the measurements.</p>
        <hr />
<div class="highlight"><pre><span></span><code>data: pandas.DataFrames
    dataframe with the measurements where first row contains
    the units or a dataframe with only the column names and units
check_metabolites: Boolean, default False
    flag to check on metabolites&#39; units
verbose: Boolean
    verbose statement (default True)
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>col_check_list: list
    quantities whose units need checking/correction
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>None (yet).
</code></pre></div>
<h6 id="mibipret.data.check_data.check_units--example">Example:</h6>
<div class="highlight"><pre><span></span><code>To be added.
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/data/check_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_units</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>                <span class="n">check_metabolites</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>                <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to check the units of the measurements.</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">    -------</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        data: pandas.DataFrames</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">            dataframe with the measurements where first row contains</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">            the units or a dataframe with only the column names and units</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">        check_metabolites: Boolean, default False</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">            flag to check on metabolites&#39; units</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">            verbose statement (default True)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">    -------</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        col_check_list: list</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">            quantities whose units need checking/correction</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    -------</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        None (yet).</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    -------</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        To be added.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;check_units()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Provided data is not a data frame.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="n">units</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="n">units</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="c1">### testing if provided data frame contains any unit</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">test_unit</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">all_units</span><span class="p">:</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="k">if</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">units</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>            <span class="n">test_unit</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="k">break</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">test_unit</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error: The second line in the dataframe is supposed</span><span class="se">\</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="s2">                         to specify the units. No units were detected in this</span><span class="se">\</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="s2">                         line, check www.mibipretdocs.nl/dataloading.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="c1"># standardize column names (as it might not has happened for data yet)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="n">check_columns</span><span class="p">(</span><span class="n">units</span><span class="p">,</span><span class="n">standardize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">check_metabolites</span><span class="o">=</span><span class="n">check_metabolites</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="n">col_check_list</span><span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>    <span class="k">for</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="n">units</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="k">if</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">chemical_composition</span><span class="p">:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>            <span class="k">if</span> <span class="n">units</span><span class="p">[</span><span class="n">quantity</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">standard_units</span><span class="p">[</span><span class="s1">&#39;mgperl&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>                <span class="n">col_check_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Check unit of </span><span class="si">{}</span><span class="s2">!</span><span class="se">\n</span><span class="s2"> Given in </span><span class="si">{}</span><span class="s2">, but must be milligramm per liter (e.g. </span><span class="si">{}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>                              <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">quantity</span><span class="p">,</span><span class="n">units</span><span class="p">[</span><span class="n">quantity</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">standard_units</span><span class="p">[</span><span class="s1">&#39;mgperl&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="k">if</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">contaminants</span><span class="p">[</span><span class="s1">&#39;all_cont&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>            <span class="k">if</span> <span class="n">units</span><span class="p">[</span><span class="n">quantity</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">standard_units</span><span class="p">[</span><span class="s1">&#39;microgperl&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>                <span class="n">col_check_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Check unit of </span><span class="si">{}</span><span class="s2">!</span><span class="se">\n</span><span class="s2"> Given in </span><span class="si">{}</span><span class="s2">, but must be microgramm per liter (e.g. </span><span class="si">{}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>                              <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">quantity</span><span class="p">,</span><span class="n">units</span><span class="p">[</span><span class="n">quantity</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">standard_units</span><span class="p">[</span><span class="s1">&#39;microgperl&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="k">if</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">units_env_cond</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="n">unit_type</span> <span class="o">=</span> <span class="n">units_env_cond</span><span class="p">[</span><span class="n">quantity</span><span class="p">]</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="k">if</span> <span class="n">units</span><span class="p">[</span><span class="n">quantity</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">standard_units</span><span class="p">[</span><span class="n">unit_type</span><span class="p">]:</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>                <span class="n">col_check_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Check unit of </span><span class="si">{}</span><span class="s2">!</span><span class="se">\n</span><span class="s2"> Given in </span><span class="si">{}</span><span class="s2">, but must be in </span><span class="si">{}</span><span class="s2"> (e.g. </span><span class="si">{}</span><span class="s2">).&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>                            <span class="n">quantity</span><span class="p">,</span><span class="n">units</span><span class="p">[</span><span class="n">quantity</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">unit_type</span><span class="p">,</span><span class="n">standard_units</span><span class="p">[</span><span class="n">unit_type</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="k">if</span> <span class="n">quantity</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">isotopes</span><span class="p">:</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>            <span class="k">if</span> <span class="n">units</span><span class="p">[</span><span class="n">quantity</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">standard_units</span><span class="p">[</span><span class="s1">&#39;permil&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>                <span class="n">col_check_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Check unit of </span><span class="si">{}</span><span class="s2">!</span><span class="se">\n</span><span class="s2"> Given in </span><span class="si">{}</span><span class="s2">, but must be per mille (e.g. </span><span class="si">{}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>                              <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">quantity</span><span class="p">,</span><span class="n">units</span><span class="p">[</span><span class="n">quantity</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">standard_units</span><span class="p">[</span><span class="s1">&#39;permil&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="k">if</span> <span class="n">check_metabolites</span><span class="p">:</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>            <span class="k">if</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="n">names_meta</span><span class="o">.</span><span class="n">metabolites</span><span class="p">[</span><span class="s1">&#39;all_meta&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>                <span class="k">if</span> <span class="n">units</span><span class="p">[</span><span class="n">quantity</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">standard_units</span><span class="p">[</span><span class="s1">&#39;microgperl&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>                    <span class="n">col_check_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Check unit of </span><span class="si">{}</span><span class="s2">!</span><span class="se">\n</span><span class="s2"> Given in </span><span class="si">{}</span><span class="s2">, but must be microgramm per liter (e.g. </span><span class="si">{}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>                                  <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">quantity</span><span class="p">,</span><span class="n">units</span><span class="p">[</span><span class="n">quantity</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">standard_units</span><span class="p">[</span><span class="s1">&#39;microgperl&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">col_check_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; All identified quantities given in requested units.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; All other identified quantities given in requested units.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="k">return</span> <span class="n">col_check_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibipret.data.check_data.check_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_values</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function that checks on value types and replaces non-measured values.</p>
        <hr />
<div class="highlight"><pre><span></span><code>data_frame: pandas.DataFrames
    dataframe with the measurements (without first row of units)
inplace: Boolean, default False
    Whether to modify the DataFrame rather than creating a new one.
verbose: Boolean
    verbose statement (default True)
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>data_pure: pandas.DataFrame
    Tabular data with standard column names and without units
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>None (yet).
</code></pre></div>
<h6 id="mibipret.data.check_data.check_values--example">Example:</h6>
<div class="highlight"><pre><span></span><code>To be added.
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/data/check_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_values</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>                 <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>                 <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>                 <span class="p">):</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function that checks on value types and replaces non-measured values.</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">    -------</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">        data_frame: pandas.DataFrames</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">            dataframe with the measurements (without first row of units)</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">        inplace: Boolean, default False</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">            Whether to modify the DataFrame rather than creating a new one.</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">            verbose statement (default True)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">    -------</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">        data_pure: pandas.DataFrame</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">            Tabular data with standard column names and without units</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">    -------</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">        None (yet).</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">    -------</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">        To be added.</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;check_values()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="n">inplace</span><span class="p">)</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>    <span class="c1">### testing if provided data frame contains first row with units</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="k">if</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">all_units</span><span class="p">:</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: First row identified as units, has been removed for value check&quot;</span><span class="p">)</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="k">break</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="k">for</span> <span class="n">sign</span> <span class="ow">in</span> <span class="n">to_replace_list</span><span class="p">:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">to_replace</span><span class="o">=</span><span class="n">sign</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">to_replace_value</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>    <span class="c1"># standardize column names (as it might not has happened for data yet)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="c1"># check_columns(data,</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="c1">#               standardize = True,</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="c1">#               check_metabolites=True,</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>    <span class="c1">#               verbose = False)</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="c1"># transform data to numeric values</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>    <span class="n">quantities_transformed</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="k">for</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span> <span class="c1">#data.columns:</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>            <span class="c1"># data_pure.loc[:,quantity] = pd.to_numeric(data_pure.loc[:,quantity])</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>            <span class="n">data</span><span class="p">[</span><span class="n">quantity</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">quantity</span><span class="p">])</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>            <span class="n">quantities_transformed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Cound not transform &#39;</span><span class="si">{}</span><span class="s2">&#39; to numerical values&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">quantity</span><span class="p">))</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Quantities with values transformed to numerical (int/float):&quot;</span><span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">quantities_transformed</span><span class="p">:</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>            <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibipret.data.check_data.standard_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">standard_names</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span> <span class="n">check_metabolites</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reduce</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function transforming list of names to standard names.</p>
<p>Function that looks at the names (of e.g. environmental variables, contaminants,
metabolites, isotopes, etc) and provides the corresponding standard names.</p>
        <hr />
<div class="highlight"><pre><span></span><code>name_list: string or list of strings
    names of quantities to be transformed to standard
check_metabolites: Boolean, default False
    Whether to check on metabolite names
standardize: Boolean, default False
    Whether to standardize identified column names
reduce: Boolean, default False
    Whether to reduce data to known quantities
verbose: Boolean, default True
    verbosity flag
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>tuple: three list containing names of
        list with identitied quantities in data (but not standardized names)
        list with unknown quantities in data (not in list of standardized names)
        list with standard names of identified quantities
</code></pre></div>
<h6 id="mibipret.data.check_data.standard_names--raises">Raises:</h6>
<p>None (yet).</p>
<h6 id="mibipret.data.check_data.standard_names--example">Example:</h6>
<p>Todo&rsquo;s:
    - complete list of potential contaminants, environmental factors
    - add name check for metabolites?</p>

            <details class="quote">
              <summary>Source code in <code>mibipret/data/check_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="k">def</span><span class="w"> </span><span class="nf">standard_names</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>                   <span class="n">check_metabolites</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>                   <span class="n">standardize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>                   <span class="n">reduce</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>                   <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>                   <span class="p">):</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function transforming list of names to standard names.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Function that looks at the names (of e.g. environmental variables, contaminants,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    metabolites, isotopes, etc) and provides the corresponding standard names.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    -------</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        name_list: string or list of strings</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">            names of quantities to be transformed to standard</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        check_metabolites: Boolean, default False</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">            Whether to check on metabolite names</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        standardize: Boolean, default False</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">            Whether to standardize identified column names</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        reduce: Boolean, default False</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            Whether to reduce data to known quantities</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        verbose: Boolean, default True</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">            verbosity flag</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    -------</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        tuple: three list containing names of</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">                list with identitied quantities in data (but not standardized names)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">                list with unknown quantities in data (not in list of standardized names)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">                list with standard names of identified quantities</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    -------</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    None (yet).</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    -------</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    Todo&#39;s:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        - complete list of potential contaminants, environmental factors</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        - add name check for metabolites?</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">names_standard</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">names_known</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">names_unknown</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">names_transform</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">dict_names</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">col_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="k">if</span> <span class="n">check_metabolites</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">dict_names</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">names_meta</span><span class="o">.</span><span class="n">names_metabolites</span><span class="p">)</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="n">name_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">name_list</span><span class="p">]</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">name_list</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Entry in provided list of names is not a string:&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">name_list</span><span class="p">:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">dict_names</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="n">x_isotope</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">y_isotopes</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">names_isotopes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x_isotope</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="k">if</span> <span class="n">y_isotopes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>            <span class="n">x_molecule</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">removeprefix</span><span class="p">(</span><span class="n">x_isotope</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>            <span class="n">y_molecule</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">names_contaminants</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x_molecule</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>            <span class="k">if</span> <span class="n">y_molecule</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>                <span class="n">names_unknown</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                <span class="n">y</span> <span class="o">=</span> <span class="n">y_isotopes</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="n">y_molecule</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>                <span class="n">names_known</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>                <span class="n">names_standard</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>                <span class="n">names_transform</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">dict_names</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>                <span class="n">names_unknown</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>                <span class="n">names_known</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                <span class="n">names_standard</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>                <span class="n">names_transform</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;standard_names()&#39;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> of </span><span class="si">{}</span><span class="s2"> quantities identified in name list.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names_known</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">name_list</span><span class="p">)))</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;List of names with standard names:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names_known</span><span class="p">):</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="s2">&quot; --&gt; &quot;</span><span class="p">,</span><span class="n">names_standard</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="k">if</span> <span class="n">standardize</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Identified column names have been standardized&quot;</span><span class="p">)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Renaming can be done by setting keyword &#39;standardize&#39; to True.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> quantities have not been identified in provided data:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names_unknown</span><span class="p">)))</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names_unknown</span><span class="p">):</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="k">if</span> <span class="n">reduce</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not identified quantities have been removed from data frame&quot;</span><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Reduction to known quantities can be done by setting keyword &#39;reduce&#39; to True.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="k">if</span> <span class="n">standardize</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="k">if</span> <span class="n">reduce</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>            <span class="k">return</span> <span class="n">names_standard</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="k">return</span> <span class="n">names_standard</span> <span class="o">+</span> <span class="n">names_unknown</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">names_standard</span><span class="p">,</span> <span class="n">names_known</span><span class="p">,</span> <span class="n">names_unknown</span><span class="p">,</span> <span class="n">names_transform</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibipret.data.check_data.standardize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">standardize</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">check_metabolites</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reduce</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">store_csv</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function providing condensed data frame with standardized names.</p>
<p>Function is checking names of columns and renames columns,
condenses data to identified column names, checks units and  names
sof data frame.</p>
<p>Function that looks at the column names and renames the columns to
the standard names of the model.</p>
        <hr />
<div class="highlight"><pre><span></span><code>data_frame: pandas.DataFrames
    dataframe with the measurements
check_metabolites: Boolean, default False
    whether to check on metabolites&#39; values
reduce: Boolean, default True
    whether to reduce data to known quantities (default True),
    otherwise full dataframe with renamed columns (for those identifyable) is returned
store_csv: Boolean, default False
    whether to save dataframe in standard format to csv-file
verbose: Boolean, default True
    verbose statement
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>data_numeric, units: pandas.DataFrames
    Tabular data with standardized column names, values in numerics etc
    and table with units for standardized column names
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>None (yet).
</code></pre></div>
<h6 id="mibipret.data.check_data.standardize--example">Example:</h6>
<p>Todo&rsquo;s:
    - complete list of potential contaminants, environmental factors
    - add name check for metabolites?
    - add key-word to specify which data to extract
        (i.e. data columns to return)</p>

            <details class="quote">
              <summary>Source code in <code>mibipret/data/check_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="k">def</span><span class="w"> </span><span class="nf">standardize</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>                <span class="n">check_metabolites</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>                <span class="n">reduce</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                <span class="n">store_csv</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>                <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>                <span class="p">):</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function providing condensed data frame with standardized names.</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">    Function is checking names of columns and renames columns,</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">    condenses data to identified column names, checks units and  names</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">    sof data frame.</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">    Function that looks at the column names and renames the columns to</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">    the standard names of the model.</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">    -------</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        data_frame: pandas.DataFrames</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">            dataframe with the measurements</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">        check_metabolites: Boolean, default False</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">            whether to check on metabolites&#39; values</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">        reduce: Boolean, default True</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">            whether to reduce data to known quantities (default True),</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">            otherwise full dataframe with renamed columns (for those identifyable) is returned</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">        store_csv: Boolean, default False</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">            whether to save dataframe in standard format to csv-file</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">        verbose: Boolean, default True</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">            verbose statement</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">    -------</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">        data_numeric, units: pandas.DataFrames</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">            Tabular data with standardized column names, values in numerics etc</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">            and table with units for standardized column names</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">    -------</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">        None (yet).</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">    -------</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">    Todo&#39;s:</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">        - complete list of potential contaminants, environmental factors</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">        - add name check for metabolites?</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">        - add key-word to specify which data to extract</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">            (i.e. data columns to return)</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;standardize()&#39; on data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Function performing check of data including:&#39;</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  * check of column names and standardizing them.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  * check of units and outlining which to adapt.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  * check of values, replacing empty values by nan </span><span class="se">\n</span><span class="s1">    and making them numeric&#39;</span><span class="p">)</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>    <span class="n">data</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span> <span class="n">check_data_frame</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>                                <span class="n">sample_name_to_index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>                                <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>    <span class="c1"># general column check &amp; standardize column names</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="n">check_columns</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>                  <span class="n">standardize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>                  <span class="n">reduce</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">,</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>                  <span class="n">check_metabolites</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>                  <span class="c1"># check_metabolites = check_metabolites,</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>                  <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>    <span class="c1"># general unit check</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>    <span class="n">units</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="n">col_check_list</span> <span class="o">=</span> <span class="n">check_units</span><span class="p">(</span><span class="n">units</span><span class="p">,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>                                 <span class="n">check_metabolites</span> <span class="o">=</span> <span class="n">check_metabolites</span><span class="p">,</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>                                 <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="c1"># transform data to numeric values</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>    <span class="n">data_numeric</span> <span class="o">=</span> <span class="n">check_values</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>                                <span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                                <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>    <span class="c1"># store standard data to file</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>    <span class="k">if</span> <span class="n">store_csv</span><span class="p">:</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">col_check_list</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data could not be saved because not all identified </span><span class="se">\n</span><span class="s2"> quantities are given in requested units.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>                <span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">store_csv</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Save standardized dataframe to file:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">store_csv</span><span class="p">)</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: data could not be saved. Check provided file path and name: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">store_csv</span><span class="p">))</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>    <span class="k">return</span> <span class="n">data_numeric</span><span class="p">,</span> <span class="n">units</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mibipret.data.example_data" class="doc doc-heading">
            <code>example_data</code>


</h3>

    <div class="doc doc-contents ">

        <p>Example dat.</p>
<p>Measurements on quantities and parameters in groundwater samples
used for biodegredation and bioremediation analysis.</p>
<p>@author: Alraune Zech</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mibipret.data.example_data.example_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">example_data</span><span class="p">(</span><span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">with_units</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function provinging test data for mibipret data analysis.</p>
        <hr />
<div class="highlight"><pre><span></span><code>data_type: string
    Type of data to return:
        -- &quot;all&quot;: all types of data available
        -- &quot;set_env_cont&quot;: well setting, environmental and contaminants data
        -- &quot;setting&quot;: well setting data only
        -- &quot;environment&quot;: data on environmental
        -- &quot;contaminants&quot;: data on contaminants
        -- &quot;metabolites&quot;: data on metabolites
        -- &quot;isotopes&quot;: data on isotopes
        -- &quot;hydro&quot;: data on hydrogeolocial conditions
with_units: Boolean, default False
    flag to provide first row with units
    if False (no units), values in columns will be numerical
    if True (with units), values in columns will be objects
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>pandas.DataFrame: Tabular data with standard column names
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>None
</code></pre></div>
<h6 id="mibipret.data.example_data.example_data--example">Example:</h6>
<div class="highlight"><pre><span></span><code>To be added!
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/data/example_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="k">def</span><span class="w"> </span><span class="nf">example_data</span><span class="p">(</span><span class="n">data_type</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>                 <span class="n">with_units</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>                 <span class="p">):</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function provinging test data for mibipret data analysis.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    -------</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        data_type: string</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">            Type of data to return:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">                -- &quot;all&quot;: all types of data available</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">                -- &quot;set_env_cont&quot;: well setting, environmental and contaminants data</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">                -- &quot;setting&quot;: well setting data only</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">                -- &quot;environment&quot;: data on environmental</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">                -- &quot;contaminants&quot;: data on contaminants</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">                -- &quot;metabolites&quot;: data on metabolites</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">                -- &quot;isotopes&quot;: data on isotopes</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">                -- &quot;hydro&quot;: data on hydrogeolocial conditions</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        with_units: Boolean, default False</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">            flag to provide first row with units</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">            if False (no units), values in columns will be numerical</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            if True (with units), values in columns will be objects</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    -------</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        pandas.DataFrame: Tabular data with standard column names</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    -------</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        None</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    -------</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        To be added!</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="n">mgl</span> <span class="o">=</span> <span class="n">standard_units</span><span class="p">[</span><span class="s1">&#39;mgperl&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">microgl</span> <span class="o">=</span> <span class="n">standard_units</span><span class="p">[</span><span class="s1">&#39;microgperl&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">setting</span> <span class="o">=</span> <span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_sample</span><span class="p">,</span><span class="n">names</span><span class="o">.</span><span class="n">name_observation_well</span><span class="p">,</span><span class="n">names</span><span class="o">.</span><span class="n">name_sample_depth</span><span class="p">]</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">setting_units</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">standard_units</span><span class="p">[</span><span class="s1">&#39;meter&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">setting_s01</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2000-001&#39;</span><span class="p">,</span> <span class="s1">&#39;B-MLS1-3-12&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.</span><span class="p">]</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">setting_s02</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2000-002&#39;</span><span class="p">,</span> <span class="s1">&#39;B-MLS1-5-15&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.5</span><span class="p">]</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">setting_s03</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2000-003&#39;</span><span class="p">,</span> <span class="s1">&#39;B-MLS1-6-17&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.</span><span class="p">]</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">setting_s04</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2000-004&#39;</span><span class="p">,</span> <span class="s1">&#39;B-MLS1-7-19&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.</span><span class="p">]</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">environment</span> <span class="o">=</span> <span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_pH</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>                   <span class="n">names</span><span class="o">.</span><span class="n">name_EC</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>                   <span class="n">names</span><span class="o">.</span><span class="n">name_redox</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>                   <span class="n">names</span><span class="o">.</span><span class="n">name_oxygen</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>                   <span class="n">names</span><span class="o">.</span><span class="n">name_nitrate</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>                   <span class="n">names</span><span class="o">.</span><span class="n">name_nitrite</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>                   <span class="n">names</span><span class="o">.</span><span class="n">name_sulfate</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>                   <span class="n">names</span><span class="o">.</span><span class="n">name_ammonium</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>                   <span class="n">names</span><span class="o">.</span><span class="n">name_sulfide</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>                   <span class="n">names</span><span class="o">.</span><span class="n">name_methane</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>                   <span class="n">names</span><span class="o">.</span><span class="n">name_ironII</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>                   <span class="n">names</span><span class="o">.</span><span class="n">name_manganese</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>                   <span class="n">names</span><span class="o">.</span><span class="n">name_phosphate</span><span class="p">]</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="n">environment_units</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">standard_units</span><span class="p">[</span><span class="s1">&#39;microsimpercm&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">standard_units</span><span class="p">[</span><span class="s1">&#39;millivolt&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>                         <span class="n">mgl</span><span class="p">,</span><span class="n">mgl</span><span class="p">,</span><span class="n">mgl</span><span class="p">,</span><span class="n">mgl</span><span class="p">,</span><span class="n">mgl</span><span class="p">,</span><span class="n">mgl</span><span class="p">,</span><span class="n">mgl</span><span class="p">,</span><span class="n">mgl</span><span class="p">,</span><span class="n">mgl</span><span class="p">,</span><span class="n">mgl</span><span class="p">]</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">environment_s01</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.23</span><span class="p">,</span> <span class="mf">322.</span><span class="p">,</span> <span class="o">-</span><span class="mf">208.</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">122.</span><span class="p">,</span><span class="mf">0.58</span><span class="p">,</span> <span class="mf">23.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">748.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span><span class="mf">1.6</span><span class="p">]</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">environment_s02</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.67</span><span class="p">,</span> <span class="mf">405.</span><span class="p">,</span> <span class="o">-</span><span class="mf">231.</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">5.</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">2022.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">environment_s03</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.75</span><span class="p">,</span> <span class="mf">223.</span><span class="p">,</span> <span class="o">-</span><span class="mf">252.</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">13.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">200.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span><span class="mf">0.8</span><span class="p">]</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">environment_s04</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.53</span><span class="p">,</span> <span class="mf">58.</span><span class="p">,</span> <span class="o">-</span><span class="mf">317.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">180.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">9.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">122.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">contaminants</span> <span class="o">=</span> <span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_benzene</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>                    <span class="n">names</span><span class="o">.</span><span class="n">name_toluene</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>                    <span class="n">names</span><span class="o">.</span><span class="n">name_ethylbenzene</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>                    <span class="n">names</span><span class="o">.</span><span class="n">name_pm_xylene</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                    <span class="n">names</span><span class="o">.</span><span class="n">name_o_xylene</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>                    <span class="n">names</span><span class="o">.</span><span class="n">name_indane</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>                    <span class="n">names</span><span class="o">.</span><span class="n">name_indene</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>                    <span class="n">names</span><span class="o">.</span><span class="n">name_naphthalene</span><span class="p">]</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="n">contaminants_units</span> <span class="o">=</span> <span class="p">[</span><span class="n">microgl</span><span class="p">,</span><span class="n">microgl</span><span class="p">,</span><span class="n">microgl</span><span class="p">,</span><span class="n">microgl</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>                          <span class="n">microgl</span><span class="p">,</span><span class="n">microgl</span><span class="p">,</span><span class="n">microgl</span><span class="p">,</span><span class="n">microgl</span><span class="p">]</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">contaminants_s01</span> <span class="o">=</span> <span class="p">[</span><span class="mf">263.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">269.</span><span class="p">,</span> <span class="mf">14.</span><span class="p">,</span> <span class="mf">51.</span><span class="p">,</span> <span class="mf">1254.</span><span class="p">,</span> <span class="mf">41.</span><span class="p">,</span> <span class="mf">2207.</span><span class="p">]</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">contaminants_s02</span> <span class="o">=</span> <span class="p">[</span><span class="mf">179.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span> <span class="mf">1690.</span><span class="p">,</span> <span class="mf">751.</span><span class="p">,</span> <span class="mf">253.</span><span class="p">,</span> <span class="mf">1352.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">,</span> <span class="mf">5410.</span><span class="p">]</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">contaminants_s03</span> <span class="o">=</span> <span class="p">[</span><span class="mf">853.</span><span class="p">,</span> <span class="mf">17.</span><span class="p">,</span> <span class="mf">1286.</span><span class="p">,</span> <span class="mf">528.</span><span class="p">,</span> <span class="mf">214.</span><span class="p">,</span> <span class="mf">1031.</span><span class="p">,</span> <span class="mf">31.</span><span class="p">,</span> <span class="mf">3879.</span><span class="p">]</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">contaminants_s04</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1254.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">1202.</span><span class="p">,</span> <span class="mf">79.</span><span class="p">,</span> <span class="mf">61.</span><span class="p">,</span> <span class="mf">814.</span><span class="p">,</span> <span class="mf">59.</span><span class="p">,</span> <span class="mf">1970.</span><span class="p">]</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="n">metabolites</span> <span class="o">=</span> <span class="p">[</span><span class="n">names_meta</span><span class="o">.</span><span class="n">name_phenol</span><span class="p">,</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>                   <span class="n">names_meta</span><span class="o">.</span><span class="n">name_cinnamic_acid</span><span class="p">,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>                   <span class="n">names_meta</span><span class="o">.</span><span class="n">name_benzoic_acid</span><span class="p">]</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="n">metabolites_units</span> <span class="o">=</span> <span class="p">[</span><span class="n">microgl</span><span class="p">,</span><span class="n">microgl</span><span class="p">,</span><span class="n">microgl</span><span class="p">]</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="n">metabolites_s01</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">]</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">metabolites_s02</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="n">metabolites_s03</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">11.4</span><span class="p">,</span> <span class="mf">5.4</span><span class="p">]</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">metabolites_s04</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="c1"># isotopes = [&#39;delta_13C-benzene&#39;,&#39;delta_2H-benzene&#39;]</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">isotopes</span> <span class="o">=</span> <span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_13C</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="n">names</span><span class="o">.</span><span class="n">name_benzene</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                <span class="n">names</span><span class="o">.</span><span class="n">name_2H</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="n">names</span><span class="o">.</span><span class="n">name_benzene</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>                <span class="p">]</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">isotopes_units</span> <span class="o">=</span> <span class="p">[</span><span class="n">standard_units</span><span class="p">[</span><span class="s1">&#39;permil&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">standard_units</span><span class="p">[</span><span class="s1">&#39;permil&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="n">isotopes_s01</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">26.1</span><span class="p">,</span><span class="o">-</span><span class="mf">106.</span><span class="p">]</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="n">isotopes_s02</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">25.8</span><span class="p">,</span><span class="o">-</span><span class="mf">110.</span><span class="p">]</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">isotopes_s03</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">24.1</span><span class="p">,</span><span class="o">-</span><span class="mf">118.</span><span class="p">]</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">isotopes_s04</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">24.1</span><span class="p">,</span><span class="o">-</span><span class="mf">117.</span><span class="p">]</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">if</span>  <span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;setting&#39;</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">setting_units</span><span class="p">,</span><span class="n">setting_s01</span><span class="p">,</span><span class="n">setting_s02</span><span class="p">,</span><span class="n">setting_s03</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>                             <span class="n">setting_s04</span><span class="p">],</span><span class="n">columns</span> <span class="o">=</span> <span class="n">setting</span><span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="k">elif</span>  <span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;environment&#39;</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">units</span> <span class="o">=</span> <span class="n">setting_units</span><span class="o">+</span><span class="n">environment_units</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">columns</span> <span class="o">=</span> <span class="n">setting</span><span class="o">+</span><span class="n">environment</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">sample_01</span> <span class="o">=</span> <span class="n">setting_s01</span><span class="o">+</span><span class="n">environment_s01</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">sample_02</span> <span class="o">=</span> <span class="n">setting_s02</span><span class="o">+</span><span class="n">environment_s02</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">sample_03</span> <span class="o">=</span> <span class="n">setting_s03</span><span class="o">+</span><span class="n">environment_s03</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="n">sample_04</span> <span class="o">=</span> <span class="n">setting_s04</span><span class="o">+</span><span class="n">environment_s04</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">units</span><span class="p">,</span><span class="n">sample_01</span><span class="p">,</span><span class="n">sample_02</span><span class="p">,</span><span class="n">sample_03</span><span class="p">,</span><span class="n">sample_04</span><span class="p">],</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>                            <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">elif</span>  <span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;contaminants&#39;</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="n">units</span> <span class="o">=</span> <span class="n">setting_units</span><span class="o">+</span><span class="n">contaminants_units</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">columns</span> <span class="o">=</span> <span class="n">setting</span><span class="o">+</span><span class="n">contaminants</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="n">sample_01</span> <span class="o">=</span> <span class="n">setting_s01</span><span class="o">+</span><span class="n">contaminants_s01</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="n">sample_02</span> <span class="o">=</span> <span class="n">setting_s02</span><span class="o">+</span><span class="n">contaminants_s02</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="n">sample_03</span> <span class="o">=</span> <span class="n">setting_s03</span><span class="o">+</span><span class="n">contaminants_s03</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">sample_04</span> <span class="o">=</span> <span class="n">setting_s04</span><span class="o">+</span><span class="n">contaminants_s04</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">units</span><span class="p">,</span><span class="n">sample_01</span><span class="p">,</span><span class="n">sample_02</span><span class="p">,</span><span class="n">sample_03</span><span class="p">,</span><span class="n">sample_04</span><span class="p">],</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>                            <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="k">elif</span>  <span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;metabolites&#39;</span><span class="p">:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="n">units</span> <span class="o">=</span> <span class="n">setting_units</span><span class="o">+</span><span class="n">metabolites_units</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="n">columns</span> <span class="o">=</span> <span class="n">setting</span><span class="o">+</span><span class="n">metabolites</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="n">sample_01</span> <span class="o">=</span> <span class="n">setting_s01</span><span class="o">+</span><span class="n">metabolites_s01</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="n">sample_02</span> <span class="o">=</span> <span class="n">setting_s02</span><span class="o">+</span><span class="n">metabolites_s02</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="n">sample_03</span> <span class="o">=</span> <span class="n">setting_s03</span><span class="o">+</span><span class="n">metabolites_s03</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="n">sample_04</span> <span class="o">=</span> <span class="n">setting_s04</span><span class="o">+</span><span class="n">metabolites_s04</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">units</span><span class="p">,</span><span class="n">sample_01</span><span class="p">,</span><span class="n">sample_02</span><span class="p">,</span><span class="n">sample_03</span><span class="p">,</span><span class="n">sample_04</span><span class="p">],</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                            <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="k">elif</span>  <span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;isotopes&#39;</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="n">units</span> <span class="o">=</span> <span class="n">setting_units</span><span class="o">+</span><span class="n">isotopes_units</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">columns</span> <span class="o">=</span> <span class="n">setting</span><span class="o">+</span><span class="n">isotopes</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">sample_01</span> <span class="o">=</span> <span class="n">setting_s01</span><span class="o">+</span><span class="n">isotopes_s01</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="n">sample_02</span> <span class="o">=</span> <span class="n">setting_s02</span><span class="o">+</span><span class="n">isotopes_s02</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">sample_03</span> <span class="o">=</span> <span class="n">setting_s03</span><span class="o">+</span><span class="n">isotopes_s03</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="n">sample_04</span> <span class="o">=</span> <span class="n">setting_s04</span><span class="o">+</span><span class="n">isotopes_s04</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">units</span><span class="p">,</span><span class="n">sample_01</span><span class="p">,</span><span class="n">sample_02</span><span class="p">,</span><span class="n">sample_03</span><span class="p">,</span><span class="n">sample_04</span><span class="p">],</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>                            <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s2">&quot;set_env_cont&quot;</span><span class="p">:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="n">units</span> <span class="o">=</span> <span class="n">setting_units</span><span class="o">+</span><span class="n">environment_units</span><span class="o">+</span><span class="n">contaminants_units</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">columns</span> <span class="o">=</span> <span class="n">setting</span><span class="o">+</span><span class="n">environment</span><span class="o">+</span><span class="n">contaminants</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">sample_01</span> <span class="o">=</span> <span class="n">setting_s01</span><span class="o">+</span><span class="n">environment_s01</span><span class="o">+</span><span class="n">contaminants_s01</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">sample_02</span> <span class="o">=</span> <span class="n">setting_s02</span><span class="o">+</span><span class="n">environment_s02</span><span class="o">+</span><span class="n">contaminants_s02</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">sample_03</span> <span class="o">=</span> <span class="n">setting_s03</span><span class="o">+</span><span class="n">environment_s03</span><span class="o">+</span><span class="n">contaminants_s03</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="n">sample_04</span> <span class="o">=</span> <span class="n">setting_s04</span><span class="o">+</span><span class="n">environment_s04</span><span class="o">+</span><span class="n">contaminants_s04</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">units</span><span class="p">,</span><span class="n">sample_01</span><span class="p">,</span><span class="n">sample_02</span><span class="p">,</span><span class="n">sample_03</span><span class="p">,</span><span class="n">sample_04</span><span class="p">],</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>                            <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="n">units</span> <span class="o">=</span> <span class="n">setting_units</span><span class="o">+</span><span class="n">environment_units</span><span class="o">+</span><span class="n">contaminants_units</span><span class="o">+</span><span class="n">metabolites_units</span> <span class="o">+</span> <span class="n">isotopes_units</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">columns</span> <span class="o">=</span> <span class="n">setting</span><span class="o">+</span><span class="n">environment</span><span class="o">+</span><span class="n">contaminants</span><span class="o">+</span><span class="n">metabolites</span> <span class="o">+</span> <span class="n">isotopes</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">sample_01</span> <span class="o">=</span> <span class="n">setting_s01</span><span class="o">+</span><span class="n">environment_s01</span><span class="o">+</span><span class="n">contaminants_s01</span><span class="o">+</span><span class="n">metabolites_s01</span><span class="o">+</span><span class="n">isotopes_s01</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="n">sample_02</span> <span class="o">=</span> <span class="n">setting_s02</span><span class="o">+</span><span class="n">environment_s02</span><span class="o">+</span><span class="n">contaminants_s02</span><span class="o">+</span><span class="n">metabolites_s02</span><span class="o">+</span><span class="n">isotopes_s02</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="n">sample_03</span> <span class="o">=</span> <span class="n">setting_s03</span><span class="o">+</span><span class="n">environment_s03</span><span class="o">+</span><span class="n">contaminants_s03</span><span class="o">+</span><span class="n">metabolites_s03</span><span class="o">+</span><span class="n">isotopes_s03</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="n">sample_04</span> <span class="o">=</span> <span class="n">setting_s04</span><span class="o">+</span><span class="n">environment_s04</span><span class="o">+</span><span class="n">contaminants_s04</span><span class="o">+</span><span class="n">metabolites_s04</span><span class="o">+</span><span class="n">isotopes_s04</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">units</span><span class="p">,</span><span class="n">sample_01</span><span class="p">,</span><span class="n">sample_02</span><span class="p">,</span><span class="n">sample_03</span><span class="p">,</span><span class="n">sample_04</span><span class="p">],</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                            <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Specified data type &#39;</span><span class="si">{}</span><span class="s2">&#39; not available&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data_type</span><span class="p">))</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">with_units</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="k">for</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="n">data</span><span class="p">[</span><span class="n">quantity</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">quantity</span><span class="p">])</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mibipret.data.load_data" class="doc doc-heading">
            <code>load_data</code>


</h3>

    <div class="doc doc-contents ">

        <p>Functions for data I/O handling.</p>
<p>@author: Alraune Zech</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mibipret.data.load_data.load_csv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_csv</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">store_provenance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function to load data from csv file.</p>
        <hr />
<div class="highlight"><pre><span></span><code>file_path: str
    Name of the path to the file
verbose: Boolean
    verbose flag
store_provenance: Boolean
    To add!
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    Tabular data
units: pd.DataFrame
    Tabular data on units
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>ValueError: If `file_path` is not a valid file location
</code></pre></div>
<h6 id="mibipret.data.load_data.load_csv--example">Example:</h6>
<p>This function can be called with the file path of the example data as
   argument using:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from mibipret.data import load_excel
&gt;&gt;&gt; load_excel(example_data.csv)
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/data/load_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_csv</span><span class="p">(</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="n">file_path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="n">store_provenance</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="p">):</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to load data from csv file.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    -------</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        file_path: str</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            Name of the path to the file</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            verbose flag</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        store_provenance: Boolean</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            To add!</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">    -------</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">            Tabular data</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        units: pd.DataFrame</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">            Tabular data on units</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    -------</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        ValueError: If `file_path` is not a valid file location</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    -------</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">       This function can be called with the file path of the example data as</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">       argument using:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        &gt;&gt;&gt; from mibipret.data import load_excel</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        &gt;&gt;&gt; load_excel(example_data.csv)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="k">if</span> <span class="n">file_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Specify file path and file name!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="s1">&#39;Cannot access file at : &#39;</span><span class="p">,</span><span class="n">file_path</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;unicode_escape&quot;</span><span class="p">)</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="k">if</span> <span class="s2">&quot;;&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;unicode_escape&quot;</span><span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">units</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;load_csv()&#39; on data file &quot;</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Units of quantities:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loaded data as pandas DataFrame:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">units</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibipret.data.load_data.load_excel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_excel</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">store_provenance</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function to load data from excel file.</p>
        <hr />
<div class="highlight"><pre><span></span><code>file_path: str
    Name of the path to the file
sheet_name: int
    Number of the sheet in the excel file to load
verbose: Boolean
    verbose flag
store_provenance: Boolean
    To add!
**kwargs: optional keyword arguments to pass to pandas&#39; routine
    read_excel()
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    Tabular data
units: pd.DataFrame
    Tabular data on units
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>ValueError: If `file_path` is not a valid file location
</code></pre></div>
<h6 id="mibipret.data.load_data.load_excel--example">Example:</h6>
<p>This function can be called with the file path of the example data as
   argument using:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from mibipret.data import load_excel
&gt;&gt;&gt; load_excel(example_data.xlsx)
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/data/load_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_excel</span><span class="p">(</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>        <span class="n">file_path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>        <span class="n">sheet_name</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>        <span class="n">store_provenance</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="p">):</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to load data from excel file.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    -------</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        file_path: str</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">            Name of the path to the file</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        sheet_name: int</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">            Number of the sheet in the excel file to load</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        verbose: Boolean</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">            verbose flag</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        store_provenance: Boolean</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">            To add!</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        **kwargs: optional keyword arguments to pass to pandas&#39; routine</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">            read_excel()</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    -------</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">            Tabular data</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        units: pd.DataFrame</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">            Tabular data on units</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    -------</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        ValueError: If `file_path` is not a valid file location</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    -------</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">       This function can be called with the file path of the example data as</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">       argument using:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        &gt;&gt;&gt; from mibipret.data import load_excel</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        &gt;&gt;&gt; load_excel(example_data.xlsx)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="k">if</span> <span class="n">file_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Specify file path and file name!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="s1">&#39;Cannot access file at : &#39;</span><span class="p">,</span><span class="n">file_path</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>                         <span class="n">sheet_name</span> <span class="o">=</span> <span class="n">sheet_name</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>                         <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="k">if</span> <span class="s2">&quot;;&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>                             <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>                             <span class="n">sheet_name</span> <span class="o">=</span> <span class="n">sheet_name</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>                             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">units</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;load_excel()&#39; on data file &quot;</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==============================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unit of quantities:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;________________________________________________________________&#39;</span><span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loaded data as pandas DataFrame:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">units</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mibipret.data.names_data" class="doc doc-heading">
            <code>names_data</code>


</h3>

    <div class="doc doc-contents ">

        <p>Name specifications of data!</p>
<p>File containing name specifications of quantities and parameters measured in
groundwater samples useful for biodegredation and bioremediation analysis</p>
<p>@author: A. Zech</p>








  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mibipret.data.names_metabolites" class="doc doc-heading">
            <code>names_metabolites</code>


</h3>

    <div class="doc doc-contents ">

        <p>Name specifications of metabolite data!</p>
<p>File containing name specifications of metabolites measured in
groundwater samples useful for biodegredation and bioremediation analysis</p>
<p>@author: A. Zech</p>








  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mibipret.data.set_data" class="doc doc-heading">
            <code>set_data</code>


</h3>

    <div class="doc doc-contents ">

        <p>Functions for data extraction and merging in preparation of analysis and plotting.</p>
<p>@author: Alraune Zech</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mibipret.data.set_data.compare_lists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compare_lists</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checking overlap of two given list.</p>
<h6 id="mibipret.data.set_data.compare_lists--input">Input</h6>
<div class="highlight"><pre><span></span><code>list1: list of strings
    given extensive list (usually column names of a pd.DataFrame)
list2: list of strings
    list of names to extract/check overlap with strings in list &#39;column&#39;
verbose: Boolean, default True
    verbosity flag
</code></pre></div>
<h6 id="mibipret.data.set_data.compare_lists--output">Output</h6>
<div class="highlight"><pre><span></span><code>(intersection, remainder_list1, reminder_list2): tuple of lists
    * intersection: list of strings present in both lists &#39;list1&#39; and &#39;list2&#39;
    * remainder_list1: list of strings only present in &#39;list1&#39;
    * remainder_list2: list of strings only present in &#39;list2&#39;
</code></pre></div>
<h6 id="mibipret.data.set_data.compare_lists--example">Example:</h6>
<p>list1 = [&lsquo;test1&rsquo;,&rsquo;test2&rsquo;]
list2 =  [&lsquo;test1&rsquo;,&rsquo;test3&rsquo;]</p>
<p>([&lsquo;test1&rsquo;],[&lsquo;test2&rsquo;]['test3']) = compare_lists(list1,list2)</p>

            <details class="quote">
              <summary>Source code in <code>mibipret/data/set_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="k">def</span><span class="w"> </span><span class="nf">compare_lists</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>                  <span class="n">list2</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>                  <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>                  <span class="p">):</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checking overlap of two given list.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    Input</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    -----</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        list1: list of strings</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">            given extensive list (usually column names of a pd.DataFrame)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        list2: list of strings</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">            list of names to extract/check overlap with strings in list &#39;column&#39;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        verbose: Boolean, default True</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            verbosity flag</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    Output</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    ------</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        (intersection, remainder_list1, reminder_list2): tuple of lists</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            * intersection: list of strings present in both lists &#39;list1&#39; and &#39;list2&#39;</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">            * remainder_list1: list of strings only present in &#39;list1&#39;</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            * remainder_list2: list of strings only present in &#39;list2&#39;</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    -------</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    list1 = [&#39;test1&#39;,&#39;test2&#39;]</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">    list2 =  [&#39;test1&#39;,&#39;test3&#39;]</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    ([&#39;test1&#39;],[&#39;test2&#39;][&#39;test3&#39;]) = compare_lists(list1,list2)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">intersection</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">list2</span><span class="p">))</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">remainder_list1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">list2</span><span class="p">))</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">remainder_list2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">list2</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">list1</span><span class="p">))</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Running function &#39;extract_variables()&#39;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================================================================&#39;</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;strings present in both lists:&quot;</span><span class="p">,</span> <span class="n">intersection</span><span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;strings only present in either of the lists:&quot;</span><span class="p">,</span> <span class="n">remainder_list1</span> <span class="o">+</span>  <span class="n">remainder_list2</span><span class="p">)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">intersection</span><span class="p">,</span><span class="n">remainder_list1</span><span class="p">,</span><span class="n">remainder_list2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibipret.data.set_data.extract_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_data</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span> <span class="n">name_list</span><span class="p">,</span> <span class="n">keep_setting_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Extracting data of specified variables from dataframe.</p>
        <hr />
<div class="highlight"><pre><span></span><code>data_frame: pandas.DataFrames
    dataframe with the measurements
name_list: list of strings
    list of column names to extract from dataframes
keep_setting_data: bool, default True
    Whether to keep setting data in the DataFrame.
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    dataframe with the measurements
</code></pre></div>
<h6 id="mibipret.data.set_data.extract_data--raises">Raises:</h6>
<p>None (yet).</p>
<h6 id="mibipret.data.set_data.extract_data--example">Example:</h6>
<p>To be added.</p>

            <details class="quote">
              <summary>Source code in <code>mibipret/data/set_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">extract_data</span><span class="p">(</span><span class="n">data_frame</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>                 <span class="n">name_list</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>                 <span class="n">keep_setting_data</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>                 <span class="p">):</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracting data of specified variables from dataframe.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    -------</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        data_frame: pandas.DataFrames</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">            dataframe with the measurements</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        name_list: list of strings</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">            list of column names to extract from dataframes</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        keep_setting_data: bool, default True</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">            Whether to keep setting data in the DataFrame.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    -------</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">            dataframe with the measurements</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    -------</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    None (yet).</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    -------</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    To be added.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">inter_names</span><span class="p">,</span><span class="n">r_columns</span><span class="p">,</span><span class="n">r_name_list</span> <span class="o">=</span> <span class="n">compare_lists</span><span class="p">(</span><span class="n">data_frame</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span><span class="n">name_list</span><span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inter_names</span><span class="p">)</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">name_list</span><span class="p">):</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Not all variables in name_list are identified in the data frame columns: &quot;</span><span class="p">,</span><span class="n">r_name_list</span><span class="p">)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="k">if</span> <span class="n">keep_setting_data</span><span class="p">:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="c1"># inter,r1,r2 = compare_lists(data_frame.columns.to_list(),names.setting_data+name_list)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="n">inter_settings</span><span class="p">,</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span> <span class="o">=</span> <span class="n">compare_lists</span><span class="p">(</span><span class="n">data_frame</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span><span class="n">names</span><span class="o">.</span><span class="n">setting_data</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="n">i1</span><span class="p">,</span><span class="n">rim_names</span><span class="p">,</span><span class="n">r2</span> <span class="o">=</span> <span class="n">compare_lists</span><span class="p">(</span><span class="n">inter_names</span><span class="p">,</span><span class="n">names</span><span class="o">.</span><span class="n">setting_data</span><span class="p">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="n">inter1</span> <span class="o">=</span> <span class="n">inter_settings</span> <span class="o">+</span> <span class="n">rim_names</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="n">inter1</span> <span class="o">=</span> <span class="n">inter_names</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">data_frame</span><span class="p">[</span><span class="n">inter1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibipret.data.set_data.merge_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">merge_data</span><span class="p">(</span><span class="n">data_frames_list</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_sample</span><span class="p">],</span> <span class="n">clean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Merging dataframes along columns on similar sample name.</p>
        <hr />
<div class="highlight"><pre><span></span><code>data_frames_list: list of pd.DataFrame
    list of dataframes with the measurements
how: str, default &#39;outer&#39;
    Type of merge to be performed.
    corresponds to keyword in pd.merge()
    {‘left’, ‘right’, ‘outer’, ‘inner’, ‘cross’}, default ‘outer’
on: list, default &quot;sample_nr&quot;
    Column name(s) to join on.
    corresponds to keyword in pd.merge()
clean: Boolean, default True
    Whether to drop columns which are in all provided data_frames
    (on which not to merge, potentially other settings than sample_name)
**kwargs: dict
    optional keyword arguments to be passed to pd.merge()
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>data: pd.DataFrame
    dataframe with the measurements
</code></pre></div>
<h6 id="mibipret.data.set_data.merge_data--raises">Raises:</h6>
<p>None (yet).</p>
<h6 id="mibipret.data.set_data.merge_data--example">Example:</h6>
<p>To be added.</p>

            <details class="quote">
              <summary>Source code in <code>mibipret/data/set_data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="k">def</span><span class="w"> </span><span class="nf">merge_data</span><span class="p">(</span><span class="n">data_frames_list</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>               <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>               <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="n">names</span><span class="o">.</span><span class="n">name_sample</span><span class="p">],</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>               <span class="n">clean</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>               <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>               <span class="p">):</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Merging dataframes along columns on similar sample name.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    -------</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        data_frames_list: list of pd.DataFrame</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            list of dataframes with the measurements</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        how: str, default &#39;outer&#39;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            Type of merge to be performed.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">            corresponds to keyword in pd.merge()</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            {‘left’, ‘right’, ‘outer’, ‘inner’, ‘cross’}, default ‘outer’</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        on: list, default &quot;sample_nr&quot;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            Column name(s) to join on.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            corresponds to keyword in pd.merge()</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        clean: Boolean, default True</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            Whether to drop columns which are in all provided data_frames</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">            (on which not to merge, potentially other settings than sample_name)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        **kwargs: dict</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">            optional keyword arguments to be passed to pd.merge()</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    -------</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        data: pd.DataFrame</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">            dataframe with the measurements</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    -------</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    None (yet).</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    -------</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    To be added.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_frames_list</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Provide List of DataFrames.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="n">data_merge</span> <span class="o">=</span> <span class="n">data_frames_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">for</span> <span class="n">data_add</span> <span class="ow">in</span> <span class="n">data_frames_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="k">if</span> <span class="n">clean</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="n">intersection</span><span class="p">,</span><span class="n">remainder_list1</span><span class="p">,</span><span class="n">remainder_list2</span> <span class="o">=</span> <span class="n">compare_lists</span><span class="p">(</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>                <span class="n">data_merge</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span><span class="n">data_add</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="n">intersection</span><span class="p">,</span><span class="n">remainder_list1</span><span class="p">,</span><span class="n">remainder_list2</span> <span class="o">=</span> <span class="n">compare_lists</span><span class="p">(</span><span class="n">intersection</span><span class="p">,</span><span class="n">on</span><span class="p">)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="n">data_add</span> <span class="o">=</span> <span class="n">data_add</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="n">remainder_list1</span><span class="o">+</span><span class="n">remainder_list2</span><span class="p">,</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="n">data_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data_merge</span><span class="p">,</span><span class="n">data_add</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="c1"># complete data set, where values of porosity are added (otherwise nan)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="k">return</span> <span class="n">data_merge</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mibipret.data.unit_settings" class="doc doc-heading">
            <code>unit_settings</code>


</h3>

    <div class="doc doc-contents ">

        <p>Unit specifications of data!</p>
<p>File containing unit specifications of quantities and parameters measured in
groundwater samples useful for biodegredation and bioremediation analysis.</p>
<p>@author: Alraune Zech</p>








  <div class="doc doc-children">











  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="mibipret.visualize" class="doc doc-heading">
            <code>visualize</code>


</h2>

    <div class="doc doc-contents ">

        <p>mibipret module for data visualization.</p>








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h3 id="mibipret.visualize.activity" class="doc doc-heading">
            <code>activity</code>


</h3>

    <div class="doc doc-contents ">

        <p>Activity plot.</p>
<p>@author: alraune</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mibipret.visualize.activity.activity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">activity</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function creating activity plot.</p>
<p>Activity plot showing scatter of total number of metabolites vs total concentration
of contaminant per well with color coding of NA traffic lights: red/yellow/green
corresponding to no natural attenuation going on (red), limited/unknown NA activity (yellow)
or active natural attenuation (green)</p>
<h6 id="mibipret.visualize.activity.activity--input">Input</h6>
<div class="highlight"><pre><span></span><code>data: list or pandas.DataFrame
    quantities required in plot:
        - total concentration of contaminants per sample
        - total count of metabolites per sample
        - traffic light on NA activity per sample
    if DataFrame, it contains the three required quantities with their standard names
    if list of arrays: the three quantities are given order above
    if list of pandas-Series, quantities given in standard names
save_fig: Boolean or string, optional, default is False.
    Flag to save figure to file with name provided as string. =
**kwargs: dict
    dictionary with plot settings
</code></pre></div>
<h6 id="mibipret.visualize.activity.activity--output">Output</h6>
<div class="highlight"><pre><span></span><code>fig : Figure object
    Figure object of created activity plot.
ax :  Axes object
    Axes object of created activity plot.
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/visualize/activity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="k">def</span><span class="w"> </span><span class="nf">activity</span><span class="p">(</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>        <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="p">):</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function creating activity plot.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Activity plot showing scatter of total number of metabolites vs total concentration</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    of contaminant per well with color coding of NA traffic lights: red/yellow/green</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    corresponding to no natural attenuation going on (red), limited/unknown NA activity (yellow)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    or active natural attenuation (green)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    Input</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        data: list or pandas.DataFrame</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">            quantities required in plot:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">                - total concentration of contaminants per sample</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">                - total count of metabolites per sample</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">                - traffic light on NA activity per sample</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">            if DataFrame, it contains the three required quantities with their standard names</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">            if list of arrays: the three quantities are given order above</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            if list of pandas-Series, quantities given in standard names</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        save_fig: Boolean or string, optional, default is False.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">            Flag to save figure to file with name provided as string. =</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        **kwargs: dict</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            dictionary with plot settings</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    Output</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    -------</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        fig : Figure object</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">            Figure object of created activity plot.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        ax :  Axes object</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">            Axes object of created activity plot.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">settings</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">DEF_settings</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="c1">### Handling of input data</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">meta_count</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">name_metabolites_variety</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">tot_cont</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">name_total_contaminants</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">well_color</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">name_na_traffic_light</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>            <span class="k">for</span> <span class="n">series</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>                <span class="k">if</span> <span class="n">series</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name_metabolites_variety</span><span class="p">:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>                    <span class="n">meta_count</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>                <span class="k">if</span> <span class="n">series</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name_total_contaminants</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>                    <span class="n">tot_cont</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>                <span class="k">if</span> <span class="n">series</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name_na_traffic_light</span><span class="p">:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>                    <span class="n">well_color</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>            <span class="n">tot_cont</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="n">meta_count</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>            <span class="n">well_color</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>            <span class="c1"># print(&quot;MATCH&quot;)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;List elements in data must be lists, np.arrays or pd.series.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tot_cont</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">meta_count</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">tot_cont</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">well_color</span><span class="p">):</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Provided arrays/lists/series of data must have the same length.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data needs to be DataFrame or list of at least three lists/np.arrays/pd.series.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tot_cont</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Too little data for activity plot. At least two values per quantity required.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="c1">### Creating Figure</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">tot_cont</span><span class="p">,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>               <span class="n">meta_count</span><span class="p">,</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>               <span class="n">c</span><span class="o">=</span><span class="n">well_color</span><span class="p">,</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>               <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>               <span class="n">s</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;markersize&#39;</span><span class="p">],</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>               <span class="n">ec</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;ec&#39;</span><span class="p">],</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>               <span class="n">lw</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;lw&#39;</span><span class="p">],</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>               <span class="p">)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="c1">### generate legend labels</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="k">if</span> <span class="s2">&quot;green&quot;</span> <span class="ow">in</span> <span class="n">well_color</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([],</span> <span class="p">[],</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                   <span class="n">label</span><span class="o">=</span><span class="s2">&quot;available&quot;</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>                   <span class="n">c</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                   <span class="n">s</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;markersize&#39;</span><span class="p">],</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>                   <span class="n">ec</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;ec&#39;</span><span class="p">],</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                   <span class="n">lw</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;lw&#39;</span><span class="p">],</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>                   <span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="k">if</span> <span class="s2">&quot;y&quot;</span> <span class="ow">in</span> <span class="n">well_color</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([],</span> <span class="p">[],</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>                   <span class="n">label</span><span class="o">=</span><span class="s2">&quot;limited/unknown&quot;</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>                   <span class="n">c</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>                   <span class="n">s</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;markersize&#39;</span><span class="p">],</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>                   <span class="n">ec</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;ec&#39;</span><span class="p">],</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>                   <span class="n">lw</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;lw&#39;</span><span class="p">],</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>                   <span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="k">if</span> <span class="s2">&quot;red&quot;</span> <span class="ow">in</span> <span class="n">well_color</span><span class="p">:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([],</span> <span class="p">[],</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>                   <span class="n">label</span><span class="o">=</span><span class="s2">&quot;depleted&quot;</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>                   <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>                   <span class="n">s</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;markersize&#39;</span><span class="p">],</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>                   <span class="n">ec</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;ec&#39;</span><span class="p">],</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>                   <span class="n">lw</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;lw&#39;</span><span class="p">],</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>                   <span class="p">)</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="c1">### Adapt plot optics</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Concentration contaminants [$\mu$g/L]&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;textsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Metabolite variety&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;textsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;textsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;textsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Electron acceptors:&#39;</span><span class="p">,</span><span class="n">loc</span> <span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;textsize&#39;</span><span class="p">]</span> <span class="p">)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="c1">### Save figure to file if file path provided</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="k">if</span> <span class="n">save_fig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fig</span><span class="p">,</span><span class="n">dpi</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">])</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Save Figure to file:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">save_fig</span><span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Figure could not be saved. Check provided file path and name: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">save_fig</span><span class="p">))</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mibipret.visualize.ordination_plot" class="doc doc-heading">
            <code>ordination_plot</code>


</h3>

    <div class="doc doc-contents ">

        <p>Ordination plot.</p>
<p>@author: Alraune Zech</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mibipret.visualize.ordination_plot.ordination_plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ordination_plot</span><span class="p">(</span><span class="n">ordination_output</span><span class="p">,</span> <span class="n">plot_loadings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_scores</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rescale_loadings_scores</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">adjust_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale_focus</span><span class="o">=</span><span class="s1">&#39;loadings&#39;</span><span class="p">,</span> <span class="n">axis_ranges</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Function creating ordination plot.</p>
<p>Based on ordination analysis providing ordination loadings and scores.</p>
<h6 id="mibipret.visualize.ordination_plot.ordination_plot--input">Input</h6>
<div class="highlight"><pre><span></span><code>ordination_output : Dictionary
    contains ordination results:
        - as numpy arrays; ordination loading and scores
        - names of the samples and the Environmental and Species variables
        - method : String (pca, cca, rda) The ordination method used in the analysis.
plot_loadings : Boolean; default is True
    flag to plot the ordination loadings
plot_scores : Boolean; default is True
    flag to plot the ordiantion scores
rescale_loadings_scores : Boolean; default is False
    flag to rescale loadings and scores to have a loading close to 1
adjust_text : Boolean, default is True
    flag to perform automized adjustment of text labes of loadings and scores to avoid overlap
scale_focus : String, default is &quot;loadings&quot;
    flag to specify if scaling focusses on either &#39;loadings&#39; or &#39;scores&#39; or &#39;none&#39;.
axis_ranges : Boolean or list/array of 4 values, default is False,
    if array or list it gives fixed x and y axis dimensions [x_min, x_maxm y_min, y_max]
save_fig: Boolean or string, optional, default is False.
    Flag to save figure to file with name provided as string.
**kwargs: dict
    dictionary with plot settings (e.g. fonts, arrow specifics, etc)
</code></pre></div>
<h6 id="mibipret.visualize.ordination_plot.ordination_plot--output">Output</h6>
<div class="highlight"><pre><span></span><code>fig : Figure object
    Figure object of created activity plot.
ax :  Axes object
    Axes object of created activity plot.
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/visualize/ordination_plot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="k">def</span><span class="w"> </span><span class="nf">ordination_plot</span><span class="p">(</span><span class="n">ordination_output</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>                    <span class="n">plot_loadings</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>                    <span class="n">plot_scores</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>                    <span class="n">rescale_loadings_scores</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>                    <span class="n">adjust_text</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>                    <span class="n">scale_focus</span> <span class="o">=</span> <span class="s2">&quot;loadings&quot;</span><span class="p">,</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>                    <span class="n">axis_ranges</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>                    <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>                    <span class="p">):</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Function creating ordination plot.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    Based on ordination analysis providing ordination loadings and scores.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    Input</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    -----</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        ordination_output : Dictionary</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            contains ordination results:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">                - as numpy arrays; ordination loading and scores</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">                - names of the samples and the Environmental and Species variables</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">                - method : String (pca, cca, rda) The ordination method used in the analysis.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        plot_loadings : Boolean; default is True</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">            flag to plot the ordination loadings</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        plot_scores : Boolean; default is True</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">            flag to plot the ordiantion scores</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        rescale_loadings_scores : Boolean; default is False</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">            flag to rescale loadings and scores to have a loading close to 1</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        adjust_text : Boolean, default is True</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">            flag to perform automized adjustment of text labes of loadings and scores to avoid overlap</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        scale_focus : String, default is &quot;loadings&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">            flag to specify if scaling focusses on either &#39;loadings&#39; or &#39;scores&#39; or &#39;none&#39;.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        axis_ranges : Boolean or list/array of 4 values, default is False,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">            if array or list it gives fixed x and y axis dimensions [x_min, x_maxm y_min, y_max]</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        save_fig: Boolean or string, optional, default is False.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            Flag to save figure to file with name provided as string.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        **kwargs: dict</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            dictionary with plot settings (e.g. fonts, arrow specifics, etc)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    Output</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    ------</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        fig : Figure object</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            Figure object of created activity plot.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        ax :  Axes object</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            Axes object of created activity plot.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">settings</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">DEF_settings</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="c1">### check on completeness of input ordination_output</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ordination_output</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Input data must be given as dictionary with standard output of ordination methods.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="k">if</span> <span class="s2">&quot;loadings_independent&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ordination_output</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Input dictionary does not contain data on loadings (&#39;loadings_independent&#39;)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="n">loadings_independent</span> <span class="o">=</span> <span class="n">ordination_output</span><span class="p">[</span><span class="s2">&quot;loadings_independent&quot;</span><span class="p">]</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="n">names_independent</span> <span class="o">=</span> <span class="n">ordination_output</span><span class="p">[</span><span class="s2">&quot;names_independent&quot;</span><span class="p">]</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">loadings_independent</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="n">loadings_independent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[],[]])</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="k">if</span> <span class="s2">&quot;scores&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ordination_output</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Input dictionary does not contain data on scores (&#39;scores&#39;)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">ordination_output</span><span class="p">[</span><span class="s2">&quot;scores&quot;</span><span class="p">]</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="k">if</span> <span class="s2">&quot;sample_index&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ordination_output</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">sample_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">sample_index</span> <span class="o">=</span> <span class="n">ordination_output</span><span class="p">[</span><span class="s2">&quot;sample_index&quot;</span><span class="p">]</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">if</span> <span class="s2">&quot;loadings_dependent&quot;</span> <span class="ow">in</span> <span class="n">ordination_output</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="n">loadings_dependent</span> <span class="o">=</span> <span class="n">ordination_output</span><span class="p">[</span><span class="s2">&quot;loadings_dependent&quot;</span><span class="p">]</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="n">names_dependent</span> <span class="o">=</span> <span class="n">ordination_output</span><span class="p">[</span><span class="s2">&quot;names_dependent&quot;</span><span class="p">]</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">loadings_dependent</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="n">loadings_dependent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[],[]])</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="n">loadings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loadings_independent</span><span class="p">,</span> <span class="n">loadings_dependent</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">loadings</span> <span class="o">=</span> <span class="n">loadings_independent</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="c1">### Rescale ordination_output given plot specifics</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="c1"># Determing the largest values in the PCA scores.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">max_load</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">loadings</span><span class="p">))</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">max_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">scores</span><span class="p">))</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="k">if</span> <span class="n">max_load</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">rescale_loadings_scores</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="c1"># loadings = loadings / (max_load*1.05)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">loadings</span> <span class="o">=</span> <span class="n">loadings</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_load</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="k">if</span> <span class="n">max_score</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">rescale_loadings_scores</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="c1"># scores = scores / (max_score*1.05)</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span> <span class="o">/</span> <span class="p">(</span><span class="n">max_score</span><span class="p">)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="k">if</span> <span class="n">axis_ranges</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="c1"># Takes the given axis dimensions for both ordination axes</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">x_lim_neg</span><span class="p">,</span><span class="n">x_lim_pos</span><span class="p">,</span><span class="n">y_lim_neg</span><span class="p">,</span><span class="n">y_lim_pos</span> <span class="o">=</span> <span class="n">axis_ranges</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="c1"># Adjusts axis dimensions for both ordination axes to ordination_output</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="k">if</span> <span class="n">plot_scores</span> <span class="ow">and</span> <span class="n">plot_loadings</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="c1"># When plotting both scores and loadings, scores or loadings are scaled</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="c1"># depending on the extent of the other. Depends on the input of Scale_focus.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="k">if</span> <span class="n">scale_focus</span> <span class="o">==</span> <span class="s2">&quot;loadings&quot;</span><span class="p">:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>                <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">loadings</span><span class="p">))</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="k">elif</span> <span class="n">scale_focus</span> <span class="o">==</span> <span class="s2">&quot;scores&quot;</span><span class="p">:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>                <span class="n">loadings</span> <span class="o">=</span> <span class="n">loadings</span> <span class="o">*</span>  <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">scores</span><span class="p">))</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="n">full_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loadings</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="k">elif</span> <span class="n">plot_loadings</span><span class="p">:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>            <span class="n">full_coords</span> <span class="o">=</span> <span class="n">loadings</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>            <span class="n">full_coords</span> <span class="o">=</span> <span class="n">scores</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="n">x_lim_pos</span> <span class="o">=</span> <span class="mf">0.11</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">full_coords</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="n">y_lim_pos</span> <span class="o">=</span> <span class="mf">0.11</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">full_coords</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="n">x_lim_neg</span> <span class="o">=</span> <span class="mf">0.11</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">full_coords</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="n">y_lim_neg</span> <span class="o">=</span> <span class="mf">0.11</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">full_coords</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="c1">### Create Figure, finally!</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="c1"># Plotting the ordination scores by iterating over every coordinate</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="c1"># in the scores array, if the Plot_scores parameter is set to true.</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="k">if</span> <span class="n">plot_scores</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">scores</span><span class="p">):</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>                        <span class="n">color</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;score_color&#39;</span><span class="p">],</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>                        <span class="n">marker</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;score_marker&#39;</span><span class="p">],</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>                        <span class="n">s</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;score_marker_size&#39;</span><span class="p">],</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>                        <span class="n">facecolor</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;score_facecolor&#39;</span><span class="p">],</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>                        <span class="n">edgecolor</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;score_edgecolor&#39;</span><span class="p">],</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                        <span class="n">zorder</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>                        <span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>            <span class="c1"># Plotting the name of the scores and storing it in a list for the purpose of adjusting the position later</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="n">tex</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_index</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;score_fontsize&#39;</span><span class="p">],</span><span class="n">zorder</span> <span class="o">=</span> <span class="mi">9</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>            <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tex</span><span class="p">)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">if</span> <span class="n">plot_loadings</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="c1"># Plots independent (=environmental) and dependent (=species) variables</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="c1"># with different colours and text formatting.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">loadings_independent</span><span class="p">):</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>                      <span class="n">color</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;arrow_color_independent&#39;</span><span class="p">],</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>                      <span class="n">width</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;arrow_width&#39;</span><span class="p">],</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>                      <span class="n">head_length</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;arrow_head_length&#39;</span><span class="p">],</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>                      <span class="n">head_width</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;arrow_head_width&#39;</span><span class="p">],</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                      <span class="n">zorder</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>                      <span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="c1">#Plotting the name of the loading</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="n">tex</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">names_independent</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                            <span class="n">fontstyle</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;fontstyle_independent&#39;</span><span class="p">],</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                            <span class="n">weight</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;weight_independent&#39;</span><span class="p">],</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                            <span class="n">fontsize</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;loading_fontsize&#39;</span><span class="p">],</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                            <span class="n">zorder</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                            <span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tex</span><span class="p">)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="k">if</span> <span class="s2">&quot;loadings_dependent&quot;</span> <span class="ow">in</span> <span class="n">ordination_output</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">loadings_dependent</span><span class="p">):</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>                          <span class="n">color</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;arrow_color_dependent&#39;</span><span class="p">],</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                          <span class="n">width</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;arrow_width&#39;</span><span class="p">],</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                          <span class="n">head_length</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;arrow_head_length&#39;</span><span class="p">],</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                          <span class="n">head_width</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;arrow_head_width&#39;</span><span class="p">],</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                          <span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>                <span class="n">tex</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">names_dependent</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>                                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                                <span class="n">fontstyle</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;fontstyle_dependent&#39;</span><span class="p">],</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                                <span class="n">weight</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;weight_dependent&#39;</span><span class="p">],</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>                                <span class="n">fontsize</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;loading_fontsize&#39;</span><span class="p">],</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                                <span class="n">zorder</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                                <span class="p">)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="c1"># and storing it in a list for the purpose of adjusting the position later</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>                <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tex</span><span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="c1">### Adapt plot optics</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="c1"># Plotting lines that indicate the origin</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="c1"># Setting the x and y axis limits with the previously determined values</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">x_lim_neg</span><span class="p">,</span> <span class="n">x_lim_pos</span><span class="p">)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">y_lim_neg</span><span class="p">,</span> <span class="n">y_lim_pos</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;label_fontsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="k">if</span> <span class="n">ordination_output</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;pca&#39;</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="n">percent_explained</span> <span class="o">=</span> <span class="n">ordination_output</span><span class="p">[</span><span class="s2">&quot;percent_explained&quot;</span><span class="p">]</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;PC1 (</span><span class="si">{:.1f}</span><span class="s1">%)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">percent_explained</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;label_fontsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PC2 (</span><span class="si">{:.1f}</span><span class="s1">%)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">percent_explained</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;label_fontsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ordination axis 1&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;label_fontsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ordination axis 2&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;label_fontsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="k">if</span> <span class="n">adjust_text</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="kn">from</span><span class="w"> </span><span class="nn">adjustText</span><span class="w"> </span><span class="kn">import</span> <span class="n">adjust_text</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="n">adjust_text</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: packages &#39;adjustText&#39; not installed.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; For making text adjustment, install package &#39;adjustText&#39;.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="c1">### Save figure to file if file path provided</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="k">if</span> <span class="n">save_fig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fig</span><span class="p">,</span><span class="n">dpi</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">])</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Figure saved to file:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">save_fig</span><span class="p">)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Figure could not be saved. Check provided file path and name: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">save_fig</span><span class="p">))</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="mibipret.visualize.stable_isotope_plots" class="doc doc-heading">
            <code>stable_isotope_plots</code>


</h3>

    <div class="doc doc-contents ">

        <p>Linear regression plots for stable isotope analysis in mibipret.</p>
<p>@author: Alraune Zech</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="mibipret.visualize.stable_isotope_plots.Keeling_plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Keeling_plot</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">,</span> <span class="n">relative_abundance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Creating a Keeling plot.</p>
<p>A Keeling plot is an approach to identify the isotopic composition of a
contaminating source from measured concentrations and isotopic composition
(delta) of a target species in the mix of the source and a pool. It is based
on the linear relationship of the concentration and the delta-value
which are measured over time or across a spatial interval.</p>
<p>The plot shows the inverse concentration data against the delta-values
along the linear regression line. For gaining the regression coefficients
perform a linear fitting or run</p>
<div class="highlight"><pre><span></span><code>Keeling_regression() [in the module analysis]
</code></pre></div>
<p>The parameter of interest, the delta (or relative_abundance, respectively)
of the source quantity is the intercept of linear fit with the y-axis,
or in other words, the absolute value of the linear fit function.</p>
<h6 id="mibipret.visualize.stable_isotope_plots.Keeling_plot--input">Input</h6>
<div class="highlight"><pre><span></span><code>c_mix : np.array, pd.dataframe
    total molecular mass/molar concentration of target substance
    at different locations (at a time) or at different times (at one location)
delta_mix : np.array, pd.dataframe (same length as c_mix)
    relative isotope ratio (delta-value) of target substance
relative_abundance : None or np.array, pd.dataframe (same length as c_mix), default None
    if not None it replaces delta_mix in the inverse estimation and plotting
    relative abundance of target substance
coefficients : tuple of lenght 2
    containing coefficients of the linear fit
save_fig: Boolean or string, optional, default is False.
    Flag to save figure to file with name provided as string. =
**kwargs: dict
    dictionary with plot settings
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>fig : Figure object
    Figure object of created activity plot.
ax :  Axes object
    Axes object of created activity plot.
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/visualize/stable_isotope_plots.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="k">def</span><span class="w"> </span><span class="nf">Keeling_plot</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>                 <span class="n">delta</span><span class="p">,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>                 <span class="n">coefficients</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>                 <span class="n">relative_abundance</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>                 <span class="n">save_fig</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>                 <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                 <span class="p">):</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Creating a Keeling plot.</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">    A Keeling plot is an approach to identify the isotopic composition of a</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">    contaminating source from measured concentrations and isotopic composition</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">    (delta) of a target species in the mix of the source and a pool. It is based</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">    on the linear relationship of the concentration and the delta-value</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">    which are measured over time or across a spatial interval.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">    The plot shows the inverse concentration data against the delta-values</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    along the linear regression line. For gaining the regression coefficients</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    perform a linear fitting or run</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        Keeling_regression() [in the module analysis]</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    The parameter of interest, the delta (or relative_abundance, respectively)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    of the source quantity is the intercept of linear fit with the y-axis,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    or in other words, the absolute value of the linear fit function.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    Input</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    -----</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        c_mix : np.array, pd.dataframe</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">            total molecular mass/molar concentration of target substance</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">            at different locations (at a time) or at different times (at one location)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        delta_mix : np.array, pd.dataframe (same length as c_mix)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">            relative isotope ratio (delta-value) of target substance</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        relative_abundance : None or np.array, pd.dataframe (same length as c_mix), default None</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">            if not None it replaces delta_mix in the inverse estimation and plotting</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            relative abundance of target substance</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        coefficients : tuple of lenght 2</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">            containing coefficients of the linear fit</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        save_fig: Boolean or string, optional, default is False.</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">            Flag to save figure to file with name provided as string. =</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        **kwargs: dict</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">            dictionary with plot settings</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">    --------</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        fig : Figure object</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">            Figure object of created activity plot.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        ax :  Axes object</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">            Axes object of created activity plot.</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="n">settings</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">DEF_settings</span><span class="p">)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="n">settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="k">if</span> <span class="n">relative_abundance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">relative_abundance</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">delta</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="n">text</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\delta&quot;</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">concentration</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="c1">### create plot</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;marker&#39;</span><span class="p">],</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="c1">### plot linear regression trend line</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="n">polynomial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="n">trendline_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="n">trendline_y</span> <span class="o">=</span> <span class="n">polynomial</span><span class="p">(</span><span class="n">trendline_x</span><span class="p">)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trendline_x</span><span class="p">,</span> <span class="n">trendline_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;fit_color&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;linear fit&#39;</span><span class="p">)</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>            <span class="sa">r</span><span class="s2">&quot;$</span><span class="si">{}</span><span class="s2">_{{source}} = </span><span class="si">{:.3f}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="n">coefficients</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">),</span><span class="c1">#,alpha=0.5)</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>             <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>             <span class="n">fontsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;fontsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">coefficients</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>               <span class="n">c</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;intercept_color&#39;</span><span class="p">],</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>               <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>               <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;intercept: $</span><span class="si">{}</span><span class="s1">_{{source}}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">),</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>               <span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="c1">### Adapt plot optics</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Inverse concentration $1/c$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;fontsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;fontsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span><span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1.05</span><span class="p">])</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;fontsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="c1">### Save figure to file if file path provided</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="k">if</span> <span class="n">save_fig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fig</span><span class="p">,</span><span class="n">dpi</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">])</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Save Figure to file:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">save_fig</span><span class="p">)</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Figure could not be saved. Check provided file path and name: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">save_fig</span><span class="p">))</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibipret.visualize.stable_isotope_plots.Lambda_plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Lambda_plot</span><span class="p">(</span><span class="n">delta_C</span><span class="p">,</span> <span class="n">delta_H</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Creating a Lambda plot.</p>
<p>A Lambda plot shows the δ13C versus δ2H signatures of a chemical compound.
Relative changes in the carbon and hydrogen isotope ratios can indicate the
occurrence of specific enzymatic degradation reactions. The relative changes
are indicated by the lambda-H/C value which is the slope of the linear
regression of hydrogen versus carbon isotope signatures. For gaining the
regression coefficients perform a linear fitting or run</p>
<div class="highlight"><pre><span></span><code> Lambda_regression() [in the module analysis]
</code></pre></div>


<details class="lambda-values-linking-to-specific-enzymatic-reactions" open>
  <summary>Lambda-values linking to specific enzymatic reactions</summary>
  <p>To be added!</p>
</details>        <p>Details provided in Vogt et al. [2016, 2020].</p>


<details class="references" open>
  <summary>References</summary>
  <p>C. Vogt, C. Dorer, F. Musat, and H. H. Richnow. Multi-element isotope
fractionation concepts to characterize the biodegradation of hydrocarbons
- from enzymes to the environment. Current Opinion in Biotechnology,
41:90–98, 2016.
C. Vogt, F. Musat, and H.-H. Richnow. Compound-Specific Isotope Analysis
for Studying the Biological Degradation of Hydrocarbons. In Anaerobic
Utilization of Hydrocarbons, Oils, and Lipids, pages 285-321.
Springer Nature Switzerland, 2020.</p>
<p>A. Fischer, I. Herklotz, S. Herrmann, M. Thullner, S. A. Weelink,
A. J. Stams, M. Schl ̈omann, H.-H. Richnow, and C. Vogt. Combined Carbon
and Hydrogen Isotope Fractionation Investigations for Elucidating
Benzene Biodegradation Pathways. Environmental Science and Technology,
42:4356–4363, 2008.</p>
<p>S. Kuemmel, F.-A. Herbst, A. Bahr, M. Arcia Duarte, D. H. Pieper,
N. Jehmlich, J. Seifert, M. Von Bergen, P. Bombach, H. H. Richnow,
and C. Vogt. Anaerobic naphthalene degradation by sulfate-reducing
Desulfobacteraceae from various anoxic aquifers.
FEMS Microbiology Ecology, 91(3), 2015.</p>
</details>        <h6 id="mibipret.visualize.stable_isotope_plots.Lambda_plot--input">Input</h6>
<div class="highlight"><pre><span></span><code>delta_C : np.array, pd.series
    relative isotope ratio (delta-value) of carbon of target molecule
delta_H : np.array, pd.series (same length as delta_C)
    relative isotope ratio (delta-value) of hydrogen of target molecule
coefficients : tuple of lenght 2
    containing coefficients of the linear fit
save_fig: Boolean or string, optional, default is False.
    Flag to save figure to file with name provided as string.
**kwargs: dict
    dictionary with plot settings
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>fig : Figure object
    Figure object of created activity plot.
ax :  Axes object
    Axes object of created activity plot.
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/visualize/stable_isotope_plots.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="k">def</span><span class="w"> </span><span class="nf">Lambda_plot</span><span class="p">(</span><span class="n">delta_C</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>                <span class="n">delta_H</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>                <span class="n">coefficients</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>                <span class="n">save_fig</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>                <span class="p">):</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Creating a Lambda plot.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    A Lambda plot shows the δ13C versus δ2H signatures of a chemical compound.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    Relative changes in the carbon and hydrogen isotope ratios can indicate the</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    occurrence of specific enzymatic degradation reactions. The relative changes</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    are indicated by the lambda-H/C value which is the slope of the linear</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    regression of hydrogen versus carbon isotope signatures. For gaining the</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    regression coefficients perform a linear fitting or run</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">         Lambda_regression() [in the module analysis]</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Lambda-values linking to specific enzymatic reactions:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        To be added!</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    Details provided in Vogt et al. [2016, 2020].</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    References:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        C. Vogt, C. Dorer, F. Musat, and H. H. Richnow. Multi-element isotope</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        fractionation concepts to characterize the biodegradation of hydrocarbons</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        - from enzymes to the environment. Current Opinion in Biotechnology,</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        41:90–98, 2016.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        C. Vogt, F. Musat, and H.-H. Richnow. Compound-Specific Isotope Analysis</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        for Studying the Biological Degradation of Hydrocarbons. In Anaerobic</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        Utilization of Hydrocarbons, Oils, and Lipids, pages 285-321.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        Springer Nature Switzerland, 2020.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        A. Fischer, I. Herklotz, S. Herrmann, M. Thullner, S. A. Weelink,</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        A. J. Stams, M. Schl ̈omann, H.-H. Richnow, and C. Vogt. Combined Carbon</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        and Hydrogen Isotope Fractionation Investigations for Elucidating</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        Benzene Biodegradation Pathways. Environmental Science and Technology,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        42:4356–4363, 2008.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        S. Kuemmel, F.-A. Herbst, A. Bahr, M. Arcia Duarte, D. H. Pieper,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        N. Jehmlich, J. Seifert, M. Von Bergen, P. Bombach, H. H. Richnow,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        and C. Vogt. Anaerobic naphthalene degradation by sulfate-reducing</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        Desulfobacteraceae from various anoxic aquifers.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        FEMS Microbiology Ecology, 91(3), 2015.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    Input</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    -----</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        delta_C : np.array, pd.series</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            relative isotope ratio (delta-value) of carbon of target molecule</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        delta_H : np.array, pd.series (same length as delta_C)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            relative isotope ratio (delta-value) of hydrogen of target molecule</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        coefficients : tuple of lenght 2</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            containing coefficients of the linear fit</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        save_fig: Boolean or string, optional, default is False.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            Flag to save figure to file with name provided as string.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        **kwargs: dict</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">            dictionary with plot settings</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    --------</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        fig : Figure object</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            Figure object of created activity plot.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        ax :  Axes object</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">            Axes object of created activity plot.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">settings</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">DEF_settings</span><span class="p">)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">delta_C</span><span class="p">,</span> <span class="n">delta_H</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;marker&#39;</span><span class="p">],</span><span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="c1">### plot linear regression trend line</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">polynomial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="n">trendline_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">delta_C</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">delta_C</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="n">trendline_y</span> <span class="o">=</span> <span class="n">polynomial</span><span class="p">(</span><span class="n">trendline_x</span><span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trendline_x</span><span class="p">,</span> <span class="n">trendline_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;fit_color&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;linear fit&#39;</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>             <span class="sa">r</span><span class="s2">&quot;$\Lambda = </span><span class="si">{:.2f}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coefficients</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">),</span><span class="c1">#,alpha=0.5),</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>             <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>             <span class="n">fontsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;fontsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="c1">### Adapt plot optics</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span><span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\delta^{{13}}$C&#39;</span><span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\delta^2$H&#39;</span><span class="p">)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;fontsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="c1">### Save figure to file if file path provided</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="k">if</span> <span class="n">save_fig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fig</span><span class="p">,</span><span class="n">dpi</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">])</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Save Figure to file:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">save_fig</span><span class="p">)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Figure could not be saved. Check provided file path and name: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">save_fig</span><span class="p">))</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="mibipret.visualize.stable_isotope_plots.Rayleigh_fractionation_plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Rayleigh_fractionation_plot</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Creating a Rayleigh fractionation plot.</p>
<p>Rayleigh fractionation is a common application to characterize the removal
of a substance from a finite pool using stable isotopes. It is based on the
change in the isotopic composition of the pool due to different kinetics of
the change in lighter and heavier isotopes.</p>
<p>We follow the most simple approach assuming that the substance removal follows
first-order kinetics, where the rate coefficients for the lighter and heavier
isotopes of the substance differ due to kinetic isotope fractionation effects.
The isotopic composition of the remaining substance in the pool will change
over time, leading to the so-called Rayleigh fractionation.</p>
<p>The plot shows the log-transformed concentration data against the delta-values
along the linear regression line. For gaining the regression coefficients
perform a linear fitting or run</p>
<div class="highlight"><pre><span></span><code>Rayleigh_fractionation() [in the module analysis]
</code></pre></div>
<p>The parameter of interest, the kinetic fractionation factor (epsilon or alpha -1)
of the removal process is the slope of the the linear trend line.</p>
<h6 id="mibipret.visualize.stable_isotope_plots.Rayleigh_fractionation_plot--input">Input</h6>
<div class="highlight"><pre><span></span><code>concentration : np.array, pd.series
    total molecular mass/molar concentration of target substance
    at different locations (at a time) or at different times (at one location)
delta : np.array, pd.series (same length as concentration)
    relative isotope ratio (delta-value) of target substance
coefficients : tuple of lenght 2
    containing coefficients of the linear fit
save_fig: Boolean or string, optional, default is False.
    Flag to save figure to file with name provided as string. =
**kwargs: dict
    dictionary with plot settings
</code></pre></div>
        <hr />
<div class="highlight"><pre><span></span><code>fig : Figure object
    Figure object of created activity plot.
ax :  Axes object
    Axes object of created activity plot.
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>mibipret/visualize/stable_isotope_plots.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="k">def</span><span class="w"> </span><span class="nf">Rayleigh_fractionation_plot</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>                                <span class="n">delta</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>                                <span class="n">coefficients</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>                                <span class="n">save_fig</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>                                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>                                <span class="p">):</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Creating a Rayleigh fractionation plot.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    Rayleigh fractionation is a common application to characterize the removal</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    of a substance from a finite pool using stable isotopes. It is based on the</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    change in the isotopic composition of the pool due to different kinetics of</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    the change in lighter and heavier isotopes.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    We follow the most simple approach assuming that the substance removal follows</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">    first-order kinetics, where the rate coefficients for the lighter and heavier</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    isotopes of the substance differ due to kinetic isotope fractionation effects.</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    The isotopic composition of the remaining substance in the pool will change</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    over time, leading to the so-called Rayleigh fractionation.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">    The plot shows the log-transformed concentration data against the delta-values</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    along the linear regression line. For gaining the regression coefficients</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">    perform a linear fitting or run</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        Rayleigh_fractionation() [in the module analysis]</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    The parameter of interest, the kinetic fractionation factor (epsilon or alpha -1)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    of the removal process is the slope of the the linear trend line.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    Input</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">    -----</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        concentration : np.array, pd.series</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            total molecular mass/molar concentration of target substance</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            at different locations (at a time) or at different times (at one location)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        delta : np.array, pd.series (same length as concentration)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            relative isotope ratio (delta-value) of target substance</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        coefficients : tuple of lenght 2</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            containing coefficients of the linear fit</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        save_fig: Boolean or string, optional, default is False.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">            Flag to save figure to file with name provided as string. =</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        **kwargs: dict</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            dictionary with plot settings</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    --------</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        fig : Figure object</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            Figure object of created activity plot.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        ax :  Axes object</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            Axes object of created activity plot.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="n">settings</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">DEF_settings</span><span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="n">settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">concentration</span><span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="c1">### create plot</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;figsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">delta</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;marker&#39;</span><span class="p">],</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="c1">### plot linear regression trend line</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="n">polynomial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="n">trendline_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="n">trendline_y</span> <span class="o">=</span> <span class="n">polynomial</span><span class="p">(</span><span class="n">trendline_x</span><span class="p">)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trendline_x</span><span class="p">,</span> <span class="n">trendline_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;fit_color&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;linear fit&#39;</span><span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>             <span class="sa">r</span><span class="s2">&quot;$\epsilon = 1-\alpha = </span><span class="si">{:.3f}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coefficients</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">),</span><span class="c1">#,alpha=0.5),</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>             <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>             <span class="n">fontsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;fontsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="c1">### Adapt plot optics</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;log-concentration $\ln c$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;fontsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\delta$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;fontsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span><span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;fontsize&#39;</span><span class="p">])</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="c1">### ---------------------------------------------------------------------------</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="c1">### Save figure to file if file path provided</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="k">if</span> <span class="n">save_fig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fig</span><span class="p">,</span><span class="n">dpi</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">])</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Save Figure to file:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">save_fig</span><span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Figure could not be saved. Check provided file path and name: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">save_fig</span><span class="p">))</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>


  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Alraune Zech, Sona Aseyednezhad, Robin Richardson, Jaro Camphuijsen
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/MiBiPreT/mibipret" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../../assets/fontawesome.min.js"></script>
      
        <script src="../../assets/solid.min.js"></script>
      
    
  </body>
</html>